{"azurerm-media-content-key-policy": "<h1 id=\"azurerm_media_content_key_policy\">azurerm_media_content_key_policy</h1><p>Manages a Content Key Policy.</p>", "example-usage": "<h2 id=\"example-usage\">Example Usage</h2><p>resource \"azurerm_resource_group\" \"example\" {<br />  name     = \"media-resources\"<br />  location = \"West Europe\"<br />}</p><br /><p>resource \"azurerm_storage_account\" \"example\" {<br />  name                     = \"examplestoracc\"<br />  resource_group_name      = azurerm_resource_group.example.name<br />  location                 = azurerm_resource_group.example.location<br />  account_tier             = \"Standard\"<br />  account_replication_type = \"GRS\"<br />}</p><br /><p>resource \"azurerm_media_services_account\" \"example\" {<br />  name                = \"examplemediaacc\"<br />  location            = azurerm_resource_group.example.location<br />  resource_group_name = azurerm_resource_group.example.name</p><br /><p>storage_account {<br />    id         = azurerm_storage_account.example.id<br />    is_primary = true<br />  }<br />}</p><br /><p>resource \"azurerm_media_content_key_policy\" \"example\" {<br />  name                        = \"example\"<br />  resource_group_name         = azurerm_resource_group.example.name<br />  media_services_account_name = azurerm_media_services_account.example.name<br />  policy_option {<br />    name = \"fairPlay\"<br />    fairplay_configuration {<br />      ask                       = \"bb566284cc124a21c435a92cd3c108c4\"<br />      pfx                       = \"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\"<br />      pfx_password              = \"password\"<br />      rental_duration_seconds   = 2249<br />      rental_and_lease_key_type = \"PersistentUnlimited\"</p><br /><pre><code>}<br />open_restriction_enabled = true<br /></code></pre><br /><p>}<br />  policy_option {<br />    name = \"playReady\"<br />    playready_configuration_license {<br />      allow_test_devices = true<br />      begin_date         = \"2017-10-16T18:22:53Z\"<br />      security_level     = \"SL150\"<br />      play_right {<br />        scms_restriction                                         = 2<br />        digital_video_only_content_restriction                   = false<br />        image_constraint_for_analog_component_video_restriction  = false<br />        image_constraint_for_analog_computer_monitor_restriction = false<br />        allow_passing_video_content_to_unknown_output            = \"NotAllowed\"<br />        uncompressed_digital_video_opl                           = 100<br />        uncompressed_digital_audio_opl                           = 100<br />        analog_video_opl                                         = 150<br />        compressed_digital_audio_opl                             = 250<br />        compressed_digital_video_opl                             = 400<br />        explicit_analog_television_output_restriction {<br />          best_effort_enforced = true<br />          control_bits         = 3<br />        }<br />      }<br />      license_type                             = \"Persistent\"<br />      content_type                             = \"UltraVioletDownload\"<br />      content_key_location_from_header_enabled = true<br />    }<br />    open_restriction_enabled = true<br />  }<br />  policy_option {<br />    name                            = \"clearKey\"<br />    clear_key_configuration_enabled = true<br />    token_restriction {<br />      issuer                      = \"urn:issuer\"<br />      audience                    = \"urn:audience\"<br />      token_type                  = \"Swt\"<br />      primary_symmetric_token_key = \"AAAAAAAAAAAAAAAAAAAAAA==\"<br />      alternate_key {<br />        rsa_token_key_exponent = \"AQAB\"<br />        rsa_token_key_modulus  = \"AQAD\"<br />      }<br />      alternate_key {<br />        symmetric_token_key = \"BBAAAAAAAAAAAAAAAAAAAA==\"<br />      }<br />    }<br />  }<br />  policy_option {<br />    name = \"widevine\"<br />    widevine_configuration_template = jsonencode({<br />      \"allowed_track_types\" : \"SD_HD\",<br />      \"content_key_specs\" : [{<br />        \"track_type\" : \"SD\",<br />        \"security_level\" : 1,<br />        \"required_output_protection\" : {<br />          \"hdcp\" : \"HDCP_V2\"<br />        },<br />      }],<br />      \"policy_overrides\" : {<br />        \"can_play\" : true,<br />        \"can_persist\" : true,<br />        \"can_renew\" : false,<br />      },<br />    })<br />    open_restriction_enabled = true<br />  }<br />}</p><br />", "arguments-reference": "<h2 id=\"arguments-reference\">Arguments Reference</h2><p>The following arguments are supported:</p><ul><li><p><code>media_services_account_name</code> - (Required) The Media Services account name. Changing this forces a new Content Key Policy to be created.</p></li><li><p><code>name</code> - (Required) The name which should be used for this Content Key Policy. Changing this forces a new Content Key Policy to be created.</p></li><li><p><code>policy_option</code> - (Required) One or more <code>policy_option</code> blocks as defined below.</p></li><li><p><code>resource_group_name</code> - (Required) The name of the Resource Group where the Content Key Policy should exist. Changing this forces a new Content Key Policy to be created.</p></li></ul><hr /><ul><li><code>description</code> - (Optional) A description for the Policy.</li></ul><hr /><p>A <code>alternate_key</code> block supports the following:</p><ul><li><p><code>rsa_token_key_exponent</code> - (Optional) The RSA parameter exponent.</p></li><li><p><code>rsa_token_key_modulus</code> - (Optional) The RSA parameter modulus.</p></li><li><p><code>symmetric_token_key</code> - (Optional) The key value of the key. Specifies a symmetric key for token validation.</p></li><li><p><code>x509_token_key_raw</code> - (Optional) The raw data field of a certificate in PKCS 12 format (X509Certificate2 in .NET). Specifies a certificate for token validation.</p></li></ul><p>-&gt; <strong>NOTE:</strong> Each <code>alternate_key</code> block can only have one type of primary verification key: if you want to use RSA you must provide <code>rsa_token_key_exponent</code> and <code>rsa_token_key_modulus</code>, if you want to use symmetric you need to provide <code>symmetric_token_key</code> and for x509 you must provide <code>x509_token_key_raw</code>. </p><hr /><p>An <code>explicit_analog_television_output_restriction</code> block supports the following:</p><ul><li><p><code>best_effort_enforced</code> - (Optional) Indicates whether this restriction is enforced on a best effort basis. Possible values are <code>true</code> or <code>false</code>. Defaults to <code>false</code>. </p></li><li><p><code>control_bits</code> - (Required) The restriction control bits. Possible value is integer between <code>0</code> and <code>3</code> inclusive.</p></li></ul><hr /><p>A <code>fairplay_configuration</code> block supports the following:</p><ul><li><p><code>ask</code> - (Optional) The key that must be used as FairPlay Application Secret key.</p></li><li><p><code>offline_rental_configuration</code> - (Optional) A <code>offline_rental_configuration</code> block as defined below.</p></li><li><p><code>pfx</code> - (Optional) The Base64 representation of FairPlay certificate in PKCS 12 (pfx) format (including private key).</p></li><li><p><code>pfx_password</code> - (Optional) The password encrypting FairPlay certificate in PKCS 12 (pfx) format.</p></li><li><p><code>rental_and_lease_key_type</code> - (Optional) The rental and lease key type. Supported values are <code>DualExpiry</code>, <code>PersistentLimited</code>, <code>PersistentUnlimited</code> or <code>Undefined</code>.</p></li><li><p><code>rental_duration_seconds</code> - (Optional) The rental duration. Must be greater than 0.</p></li></ul><hr /><p>A <code>offline_rental_configuration</code> block supports the following:</p><ul><li><p><code>playback_duration_seconds</code> - (Optional) Playback duration.</p></li><li><p><code>storage_duration_seconds</code> - (Optional) Storage duration.</p></li></ul><hr /><p>A <code>play_right</code> block supports the following:</p><ul><li><p><code>agc_and_color_stripe_restriction</code> - (Optional) Configures Automatic Gain Control (AGC) and Color Stripe in the license. Must be between <code>0</code> and <code>3</code> inclusive.</p></li><li><p><code>allow_passing_video_content_to_unknown_output</code> - (Optional) Configures Unknown output handling settings of the license. Supported values are <code>Allowed</code>, <code>AllowedWithVideoConstriction</code> or <code>NotAllowed</code>.</p></li><li><p><code>analog_video_opl</code> - (Optional) Specifies the output protection level for compressed digital audio. Supported values are <code>100</code>, <code>150</code> or <code>200</code>.</p></li><li><p><code>compressed_digital_audio_opl</code> - (Optional) Specifies the output protection level for compressed digital audio.Supported values are <code>100</code>, <code>150</code>, <code>200</code>, <code>250</code> or <code>300</code>.</p></li><li><p><code>compressed_digital_video_opl</code> - (Optional) Specifies the output protection level for compressed digital video. Supported values are <code>400</code> or <code>500</code>.</p></li><li><p><code>digital_video_only_content_restriction</code> - (Optional) Enables the Image Constraint For Analog Component Video Restriction in the license.</p></li><li><p><code>explicit_analog_television_output_restriction</code> - (Optional) An <code>explicit_analog_television_output_restriction</code> block as defined above.</p></li><li><p><code>first_play_expiration</code> - (Optional) The amount of time that the license is valid after the license is first used to play content.</p></li><li><p><code>image_constraint_for_analog_component_video_restriction</code> - (Optional) Enables the Image Constraint For Analog Component Video Restriction in the license.</p></li><li><p><code>image_constraint_for_analog_computer_monitor_restriction</code> - (Optional) Enables the Image Constraint For Analog Component Video Restriction in the license.</p></li><li><p><code>scms_restriction</code> - (Optional) Configures the Serial Copy Management System (SCMS) in the license. Must be between <code>0</code> and <code>3</code> inclusive.</p></li><li><p><code>uncompressed_digital_audio_opl</code> - (Optional) Specifies the output protection level for uncompressed digital audio. Supported values are <code>100</code>, <code>150</code>, <code>200</code>, <code>250</code> or <code>300</code>.</p></li><li><p><code>uncompressed_digital_video_opl</code> - (Optional) Specifies the output protection level for uncompressed digital video. Supported values are <code>100</code>, <code>250</code>, <code>270</code> or <code>300</code>.</p></li></ul><hr /><p>A <code>playready_configuration_license</code> block supports the following:</p><ul><li><p><code>allow_test_devices</code> - (Optional) A flag indicating whether test devices can use the license.</p></li><li><p><code>begin_date</code> - (Optional) The begin date of license.</p></li><li><p><code>content_key_location_from_header_enabled</code> - (Optional) Specifies that the content key ID is in the PlayReady header.</p></li><li><p><code>content_key_location_from_key_id</code> - (Optional) The content key ID. Specifies that the content key ID is specified in the PlayReady configuration.</p></li></ul><p>-&gt; <strong>NOTE:</strong> You can only specify one content key location. For example if you specify <code>content_key_location_from_header_enabled</code> in true, you shouldn't specify <code>content_key_location_from_key_id</code> and vice versa.</p><ul><li><p><code>content_type</code> - (Optional) The PlayReady content type. Supported values are <code>UltraVioletDownload</code>, <code>UltraVioletStreaming</code> or <code>Unspecified</code>.</p></li><li><p><code>expiration_date</code> - (Optional) The expiration date of license.</p></li><li><p><code>grace_period</code> - (Optional) The grace period of license.</p></li><li><p><code>license_type</code> - (Optional) The license type. Supported values are <code>NonPersistent</code> or <code>Persistent</code>.</p></li><li><p><code>play_right</code> - (Optional) A <code>play_right</code> block as defined above.</p></li><li><p><code>relative_begin_date</code> - (Optional) The relative begin date of license.</p></li><li><p><code>relative_expiration_date</code> - (Optional) The relative expiration date of license.</p></li><li><p><code>security_level</code> - (Optional) The security level of the PlayReady license. Possible values are <code>SL150</code>, <code>SL2000</code> and <code>SL3000</code>. Please see <a href=\"https://learn.microsoft.com/en-us/rest/api/media/content-key-policies/create-or-update?tabs=HTTP#securitylevel\">this document</a> for more information about security level. See <a href=\"https://learn.microsoft.com/en-us/azure/media-services/latest/drm-playready-license-template-concept#playready-sl3000-support\">this document</a> for more information about <code>SL3000</code> support.</p></li></ul><hr /><p>A <code>policy_option</code> block supports the following:</p><ul><li><p><code>name</code> - (Required) The name which should be used for this Policy Option.</p></li><li><p><code>clear_key_configuration_enabled</code> - (Optional) Enable a configuration for non-DRM keys.</p></li><li><p><code>fairplay_configuration</code> - (Optional) A <code>fairplay_configuration</code> block as defined above. Check license requirements here <a href=\"https://docs.microsoft.com/azure/media-services/latest/fairplay-license-overview\">https://docs.microsoft.com/azure/media-services/latest/fairplay-license-overview</a>.</p></li><li><p><code>open_restriction_enabled</code> - (Optional) Enable an open restriction. License or key will be delivered on every request.</p></li><li><p><code>playready_configuration_license</code> - (Optional) One or more <code>playready_configuration_license</code> blocks as defined above.</p></li><li><p><code>playready_response_custom_data</code> - (Optional) The custom response data of the PlayReady configuration. This only applies when <code>playready_configuration_license</code> is specified.</p></li><li><p><code>token_restriction</code> - (Optional) A <code>token_restriction</code> block as defined below.</p></li><li><p><code>widevine_configuration_template</code> - (Optional) The Widevine template.</p></li></ul><p>-&gt; <strong>NOTE:</strong> Each policy_option can only have one type of configuration: <code>fairplay_configuration</code>, <code>clear_key_configuration_enabled</code>, <code>playready_configuration_license</code> or <code>widevine_configuration_template</code>. And is possible to assign only one type of restriction: <code>open_restriction_enabled</code> or <code>token_restriction</code>.</p><hr /><p>A <code>required_claim</code> block supports the following:</p><ul><li><p><code>type</code> - (Optional) Token claim type.</p></li><li><p><code>value</code> - (Optional) Token claim value.</p></li></ul><hr /><p>A <code>token_restriction</code> block supports the following:</p><ul><li><p><code>alternate_key</code> - (Optional) One or more <code>alternate_key</code> block as defined above.</p></li><li><p><code>audience</code> - (Optional) The audience for the token.</p></li><li><p><code>issuer</code> - (Optional) The token issuer.</p></li><li><p><code>open_id_connect_discovery_document</code> - (Optional) The OpenID connect discovery document.</p></li><li><p><code>primary_rsa_token_key_exponent</code> - (Optional) The RSA parameter exponent.</p></li><li><p><code>primary_rsa_token_key_modulus</code> - (Optional) The RSA parameter modulus.</p></li><li><p><code>primary_symmetric_token_key</code> - (Optional) The key value of the key. Specifies a symmetric key for token validation.</p></li><li><p><code>primary_x509_token_key_raw</code> - (Optional) The raw data field of a certificate in PKCS 12 format (X509Certificate2 in .NET). Specifies a certificate for token validation.</p></li><li><p><code>required_claim</code> - (Optional) One or more <code>required_claim</code> blocks as defined above.</p></li><li><p><code>token_type</code> - (Optional) The type of token. Supported values are <code>Jwt</code> or <code>Swt</code>.</p></li></ul><p>-&gt; <strong>NOTE:</strong> Each token_restriction can only have one type of primary verification key: if you want to use RSA you must provide <code>primary_rsa_token_key_exponent</code> and <code>primary_rsa_token_key_modulus</code>, if you want to use symmetric you need to provide <code>primary_symmetric_token_key</code> and for x509 you must provide <code>primary_x509_token_key_raw</code>. For more information about Token access please refer to <a href=\"https://docs.microsoft.com/azure/media-services/latest/content-protection-overview#controlling-content-access\">https://docs.microsoft.com/azure/media-services/latest/content-protection-overview#controlling-content-access</a></p><hr />", "attributes-reference": "<h2 id=\"attributes-reference\">Attributes Reference</h2><p>In addition to the Arguments listed above - the following Attributes are exported:</p><ul><li><code>id</code> - The ID of the Content Key Policy.</li></ul>", "timeouts": "<h2 id=\"timeouts\">Timeouts</h2><p>The <code>timeouts</code> block allows you to specify <a href=\"https://www.terraform.io/language/resources/syntax#operation-timeouts\">timeouts</a> for certain actions:</p><ul><li><code>create</code> - (Defaults to 30 minutes) Used when creating the Content Key Policy.</li><li><code>read</code> - (Defaults to 5 minutes) Used when retrieving the Content Key Policy.</li><li><code>update</code> - (Defaults to 30 minutes) Used when updating the Content Key Policy.</li><li><code>delete</code> - (Defaults to 30 minutes) Used when deleting the Content Key Policy.</li></ul>", "import": "<h2 id=\"import\">Import</h2><p>Content Key Policy can be imported using the <code>resource id</code>, e.g.</p><p>shell<br />terraform import azurerm_media_content_key_policy.example /subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/group1/providers/Microsoft.Media/mediaServices/account1/contentKeyPolicies/policy1</p>", "description": "<h1 id=\"azurerm_media_content_key_policy\">azurerm_media_content_key_policy</h1><p>Manages a Content Key Policy.</p>"}