{"azurerm-mssql-server": "<h1 id=\"azurerm_mssql_server\">azurerm_mssql_server</h1><p>Manages a Microsoft SQL Azure Database Server.</p><p>~&gt; <strong>Note:</strong> All arguments including the administrator login and password will be stored in the raw state as plain-text.<br /><a href=\"/docs/state/sensitive-data.html\">Read more about sensitive data in state</a>.</p>", "example-usage": "<h2 id=\"example-usage\">Example Usage</h2><p><br />resource \"azurerm_resource_group\" \"example\" {<br />  name     = \"database-rg\"<br />  location = \"West Europe\"<br />}</p><p>resource \"azurerm_mssql_server\" \"example\" {<br />  name                         = \"mssqlserver\"<br />  resource_group_name          = azurerm_resource_group.example.name<br />  location                     = azurerm_resource_group.example.location<br />  version                      = \"12.0\"<br />  administrator_login          = \"missadministrator\"<br />  administrator_login_password = \"thisIsKat11\"<br />  minimum_tls_version          = \"1.2\"</p><p>azuread_administrator {<br />    login_username = \"AzureAD Admin\"<br />    object_id      = \"00000000-0000-0000-0000-000000000000\"<br />  }</p><p>tags = {<br />    environment = \"production\"<br />  }<br />}<br /></p>", "example-usage-for-transparent-data-encryption-tde-with-a-customer-managed-key-cmk-during-create": "<h2 id=\"example-usage-for-transparent-data-encryptiontde-with-a-customer-managed-keycmk-during-create\">Example Usage for Transparent Data Encryption(TDE) with a Customer Managed Key(CMK) during Create</h2><p><br />data \"azurerm_client_config\" \"current\" {}</p><p>resource \"azurerm_resource_group\" \"example\" {<br />  name     = \"example-resources\"<br />  location = \"West Europe\"<br />}</p><p>resource \"azurerm_user_assigned_identity\" \"example\" {<br />  name                = \"example-admin\"<br />  location            = azurerm_resource_group.example.location<br />  resource_group_name = azurerm_resource_group.example.name<br />}</p><p>resource \"azurerm_mssql_server\" \"example\" {<br />  name                         = \"example-resource\"<br />  resource_group_name          = azurerm_resource_group.example.name<br />  location                     = azurerm_resource_group.example.location<br />  version                      = \"12.0\"<br />  administrator_login          = \"Example-Administrator\"<br />  administrator_login_password = \"Example_Password!\"<br />  minimum_tls_version          = \"1.2\"</p><p>azuread_administrator {<br />    login_username = azurerm_user_assigned_identity.example.name<br />    object_id      = azurerm_user_assigned_identity.example.principal_id<br />  }</p><p>identity {<br />    type         = \"UserAssigned\"<br />    identity_ids = [azurerm_user_assigned_identity.example.id]<br />  }</p><p>primary_user_assigned_identity_id            = azurerm_user_assigned_identity.example.id<br />  transparent_data_encryption_key_vault_key_id = azurerm_key_vault_key.example.id<br />}</p>", "create-a-key-vault-with-access-policies-which-allow-for-the-current-user-to-get-list-create-delete-update-recover-purge-and-getrotationpolicy-for-the-key-vault-key-and-also-add-a-key-vault-access-policy-for-the-microsoft-sql-server-instance-user-managed-identity-to-get-wrap-and-unwrap-key-s": "<h1 id=\"create-a-key-vault-with-access-policies-which-allow-for-the-current-user-to-get-list-create-delete-update-recover-purge-and-getrotationpolicy-for-the-key-vault-key-and-also-add-a-key-vault-access-policy-for-the-microsoft-sql-server-instance-user-managed-identity-to-get-wrap-and-unwrap-keys\">Create a key vault with access policies which allow for the current user to get, list, create, delete, update, recover, purge and getRotationPolicy for the key vault key and also add a key vault access policy for the Microsoft Sql Server instance User Managed Identity to get, wrap, and unwrap key(s)</h1><p>resource \"azurerm_key_vault\" \"example\" {<br />  name                        = \"mssqltdeexample\"<br />  location                    = azurerm_resource_group.example.location<br />  resource_group_name         = azurerm_resource_group.example.name<br />  enabled_for_disk_encryption = true<br />  tenant_id                   = azurerm_user_assigned_identity.example.tenant_id<br />  soft_delete_retention_days  = 7<br />  purge_protection_enabled    = true</p><p>sku_name = \"standard\"</p><p>access_policy {<br />    tenant_id = data.azurerm_client_config.current.tenant_id<br />    object_id = data.azurerm_client_config.current.object_id</p><pre><code>key_permissions = [\"Get\", \"List\", \"Create\", \"Delete\", \"Update\", \"Recover\", \"Purge\", \"GetRotationPolicy\"]</code></pre><p>}</p><p>access_policy {<br />    tenant_id = azurerm_user_assigned_identity.example.tenant_id<br />    object_id = azurerm_user_assigned_identity.example.principal_id</p><pre><code>key_permissions = [\"Get\", \"WrapKey\", \"UnwrapKey\"]</code></pre><p>}<br />}</p><p>resource \"azurerm_key_vault_key\" \"example\" {<br />  depends_on = [azurerm_key_vault.example]</p><p>name         = \"example-key\"<br />  key_vault_id = azurerm_key_vault.example.id<br />  key_type     = \"RSA\"<br />  key_size     = 2048</p><p>key_opts = [\"unwrapKey\", \"wrapKey\"]<br />}</p><p></p>", "argument-reference": "<h2 id=\"argument-reference\">Argument Reference</h2><p>The following arguments are supported:</p><ul><li><p><code>name</code> - (Required) The name of the Microsoft SQL Server. This needs to be globally unique within Azure. Changing this forces a new resource to be created.</p></li><li><p><code>resource_group_name</code> - (Required) The name of the resource group in which to create the Microsoft SQL Server. Changing this forces a new resource to be created.</p></li><li><p><code>location</code> - (Required) Specifies the supported Azure location where the resource exists. Changing this forces a new resource to be created.</p></li><li><p><code>version</code> - (Required) The version for the new server. Valid values are: 2.0 (for v11 server) and 12.0 (for v12 server). Changing this forces a new resource to be created.</p></li></ul><hr /><ul><li><p><code>administrator_login</code> - (Optional) The administrator login name for the new server. Required unless <code>azuread_authentication_only</code> in the <code>azuread_administrator</code> block is <code>true</code>. When omitted, Azure will generate a default username which cannot be subsequently changed. Changing this forces a new resource to be created.</p></li><li><p><code>administrator_login_password</code> - (Optional) The password associated with the <code>administrator_login</code> user. Needs to comply with Azure's <a href=\"https://msdn.microsoft.com/library/ms161959.aspx\">Password Policy</a>. Required unless <code>azuread_authentication_only</code> in the <code>azuread_administrator</code> block is <code>true</code>.</p></li><li><p><code>azuread_administrator</code> - (Optional) An <code>azuread_administrator</code> block as defined below.</p></li><li><p><code>connection_policy</code> - (Optional) The connection policy the server will use. Possible values are <code>Default</code>, <code>Proxy</code>, and <code>Redirect</code>. Defaults to <code>Default</code>.</p></li><li><p><code>identity</code> - (Optional) An <code>identity</code> block as defined below.</p></li><li><p><code>transparent_data_encryption_key_vault_key_id</code> - (Optional) The fully versioned <code>Key Vault</code> <code>Key</code> URL (e.g. <code>'https://&lt;YourVaultName&gt;.vault.azure.net/keys/&lt;YourKeyName&gt;/&lt;YourKeyVersion&gt;</code>) to be used as the <code>Customer Managed Key</code>(CMK/BYOK) for the <code>Transparent Data Encryption</code>(TDE) layer.</p></li></ul><p>~&gt; <strong>NOTE:</strong>  To use <code>transparent_data_encryption_key_vault_key_id</code> a User Assigned identity must be specified in <code>primary_user_assigned_identity_id</code>. System Assigned Identities are not supported.</p><p>~&gt; <strong>NOTE:</strong> To successfully deploy a <code>Microsoft SQL Server</code> in CMK/BYOK TDE the <code>Key Vault</code> must have <code>Soft-delete</code> and <code>purge protection</code> enabled to protect from data loss due to accidental key and/or key vault deletion. The <code>Key Vault</code> and the <code>Microsoft SQL Server</code> <code>User Managed Identity Instance</code> must belong to the same <code>Azure Active Directory</code> <code>tenant</code>. </p><p>~&gt; <strong>NOTE:</strong>  Cross-tenant <code>Key Vault</code> and <code>Microsoft SQL Server</code> interactions are not supported. Please see the <a href=\"https://learn.microsoft.com/azure/azure-sql/database/transparent-data-encryption-byok-overview?view=azuresql#requirements-for-configuring-customer-managed-tde\">product documentation</a> for more information. </p><p>~&gt; <strong>NOTE:</strong> When using a firewall with a <code>Key Vault</code>, you must enable the option <code>Allow trusted Microsoft services to bypass the firewall</code>.</p><ul><li><code>minimum_tls_version</code> - (Optional) The Minimum TLS Version for all SQL Database and SQL Data Warehouse databases associated with the server. Valid values are: <code>1.0</code>, <code>1.1</code> , <code>1.2</code> and <code>Disabled</code>. Defaults to <code>1.2</code>.</li></ul><p>~&gt; <strong>NOTE:</strong> The <code>minimum_tls_version</code> is set to <code>Disabled</code> means all TLS versions are allowed. After you enforce a version of <code>minimum_tls_version</code>, it's not possible to revert to <code>Disabled</code>.</p><ul><li><p><code>public_network_access_enabled</code> - (Optional) Whether public network access is allowed for this server. Defaults to <code>true</code>.</p></li><li><p><code>outbound_network_restriction_enabled</code> - (Optional) Whether outbound network traffic is restricted for this server. Defaults to <code>false</code>.</p></li><li><p><code>primary_user_assigned_identity_id</code> - (Optional) Specifies the primary user managed identity id. Required if <code>type</code> is <code>UserAssigned</code> and should be combined with <code>identity_ids</code>.</p></li><li><p><code>tags</code> - (Optional) A mapping of tags to assign to the resource.</p></li></ul><hr /><p>An <code>identity</code> block supports the following:</p><ul><li><p><code>type</code> - (Required) Specifies the type of Managed Service Identity that should be configured on this SQL Server. Possible values are <code>SystemAssigned</code>, <code>UserAssigned</code>, <code>SystemAssigned, UserAssigned</code> (to enable both).</p></li><li><p><code>identity_ids</code> - (Optional) Specifies a list of User Assigned Managed Identity IDs to be assigned to this SQL Server.</p></li></ul><p>~&gt; <strong>NOTE:</strong> This is required when <code>type</code> is set to <code>UserAssigned</code></p><p>~&gt; <strong>NOTE:</strong> When <code>type</code> is set to <code>SystemAssigned</code>, the assigned <code>principal_id</code> and <code>tenant_id</code> can be retrieved after the Microsoft SQL Server has been created. More details are available below.</p><hr /><p>An <code>azuread_administrator</code> block supports the following:</p><ul><li><p><code>login_username</code> - (Required) The login username of the Azure AD Administrator of this SQL Server.</p></li><li><p><code>object_id</code> - (Required) The object id of the Azure AD Administrator of this SQL Server.</p></li><li><p><code>tenant_id</code> - (Optional) The tenant id of the Azure AD Administrator of this SQL Server.</p></li><li><p><code>azuread_authentication_only</code> - (Optional) Specifies whether only AD Users and administrators (e.g. <code>azuread_administrator.0.login_username</code>) can be used to login, or also local database users (e.g. <code>administrator_login</code>). When <code>true</code>, the <code>administrator_login</code> and <code>administrator_login_password</code> properties can be omitted.</p></li></ul>", "attributes-reference": "<h2 id=\"attributes-reference\">Attributes Reference</h2><p>In addition to the Arguments listed above - the following Attributes are exported:</p><ul><li><p><code>id</code> - the Microsoft SQL Server ID.</p></li><li><p><code>fully_qualified_domain_name</code> - The fully qualified domain name of the Azure SQL Server (e.g. myServerName.database.windows.net)</p></li><li><p><code>restorable_dropped_database_ids</code> - A list of dropped restorable database IDs on the server.</p></li></ul><hr /><p>A <code>identity</code> block exports the following:</p><ul><li><p><code>principal_id</code> - The Principal ID for the Service Principal associated with the Identity of this SQL Server.</p></li><li><p><code>tenant_id</code> - The Tenant ID for the Service Principal associated with the Identity of this SQL Server.</p></li></ul><p>-&gt; You can access the Principal ID via <code>azurerm_mssql_server.example.identity.0.principal_id</code> and the Tenant ID via <code>azurerm_mssql_server.example.identity.0.tenant_id</code></p><h3 id=\"timeouts\">Timeouts</h3><p>The <code>timeouts</code> block allows you to specify <a href=\"https://www.terraform.io/language/resources/syntax#operation-timeouts\">timeouts</a> for certain actions:</p><ul><li><code>create</code> - (Defaults to 60 minutes) Used when creating the Microsoft SQL Server.</li><li><code>update</code> - (Defaults to 60 minutes) Used when updating the Microsoft SQL Server.</li><li><code>read</code> - (Defaults to 5 minutes) Used when retrieving the Microsoft SQL Server.</li><li><code>delete</code> - (Defaults to 60 minutes) Used when deleting the Microsoft SQL Server.</li></ul>", "import": "<h2 id=\"import\">Import</h2><p>SQL Servers can be imported using the <code>resource id</code>, e.g.</p><p><code>shellterraform import azurerm_mssql_server.example /subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/myresourcegroup/providers/Microsoft.Sql/servers/myserver</code></p>", "description": "<h1 id=\"azurerm_mssql_server\">azurerm_mssql_server</h1><p>Manages a Microsoft SQL Azure Database Server.</p><p>~&gt; <strong>Note:</strong> All arguments including the administrator login and password will be stored in the raw state as plain-text.<br /><a href=\"/docs/state/sensitive-data.html\">Read more about sensitive data in state</a>.</p>"}