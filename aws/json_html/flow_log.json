{"resource-aws-flow-log": "<h1 id=\"resource-aws_flow_log\">Resource: aws_flow_log</h1><p>Provides a VPC/Subnet/ENI/Transit Gateway/Transit Gateway Attachment Flow Log to capture IP traffic for a specific network<br />interface, subnet, or VPC. Logs are sent to a CloudWatch Log Group, a S3 Bucket, or Amazon Kinesis Data Firehose</p>", "example-usage": "<h2 id=\"example-usage\">Example Usage</h2><h3 id=\"cloudwatch-logging\">CloudWatch Logging</h3><br /><p>terraform<br />resource \"aws_flow_log\" \"example\" {<br />  iam_role_arn    = aws_iam_role.example.arn<br />  log_destination = aws_cloudwatch_log_group.example.arn<br />  traffic_type    = \"ALL\"<br />  vpc_id          = aws_vpc.example.id<br />}</p><br /><p>resource \"aws_cloudwatch_log_group\" \"example\" {<br />  name = \"example\"<br />}</p><br /><p>data \"aws_iam_policy_document\" \"assume_role\" {<br />  statement {<br />    effect = \"Allow\"</p><br /><pre><code>principals {<br />  type        = \"Service\"<br />  identifiers = [\"vpc-flow-logs.amazonaws.com\"]<br />}<br /><br />actions = [\"sts:AssumeRole\"]<br /></code></pre><br /><p>}<br />}</p><br /><p>resource \"aws_iam_role\" \"example\" {<br />  name               = \"example\"<br />  assume_role_policy = data.aws_iam_policy_document.assume_role.json<br />}</p><br /><p>data \"aws_iam_policy_document\" \"example\" {<br />  statement {<br />    effect = \"Allow\"</p><br /><pre><code>actions = [<br />  \"logs:CreateLogGroup\",<br />  \"logs:CreateLogStream\",<br />  \"logs:PutLogEvents\",<br />  \"logs:DescribeLogGroups\",<br />  \"logs:DescribeLogStreams\",<br />]<br /><br />resources = [\"*\"]<br /></code></pre><br /><p>}<br />}</p><br /><p>resource \"aws_iam_role_policy\" \"example\" {<br />  name   = \"example\"<br />  role   = aws_iam_role.example.id<br />  policy = data.aws_iam_policy_document.example.json<br />}</p><br /><h3 id=\"amazon-kinesis-data-firehose-logging\">Amazon Kinesis Data Firehose logging</h3><br /><p>terraform<br />resource \"aws_flow_log\" \"example\" {<br />  log_destination      = aws_kinesis_firehose_delivery_stream.example.arn<br />  log_destination_type = \"kinesis-data-firehose\"<br />  traffic_type         = \"ALL\"<br />  vpc_id               = aws_vpc.example.id<br />}</p><br /><p>resource \"aws_kinesis_firehose_delivery_stream\" \"example\" {<br />  name        = \"kinesis_firehose_test\"<br />  destination = \"extended_s3\"</p><br /><p>extended_s3_configuration {<br />    role_arn   = aws_iam_role.example.arn<br />    bucket_arn = aws_s3_bucket.example.arn<br />  }</p><br /><p>tags = {<br />    \"LogDeliveryEnabled\" = \"true\"<br />  }<br />}</p><br /><p>resource \"aws_s3_bucket\" \"example\" {<br />  bucket = \"example\"<br />}</p><br /><p>resource \"aws_s3_bucket_acl\" \"example\" {<br />  bucket = aws_s3_bucket.example.id<br />  acl    = \"private\"<br />}</p><br /><p>data \"aws_iam_policy_document\" \"assume_role\" {<br />  statement {<br />    effect = \"Allow\"</p><br /><pre><code>principals {<br />  type        = \"Service\"<br />  identifiers = [\"firehose.amazonaws.com\"]<br />}<br /><br />actions = [\"sts:AssumeRole\"]<br /></code></pre><br /><p>}<br />}</p><br /><p>resource \"aws_iam_role\" \"example\" {<br />  name               = \"firehose_test_role\"<br />  assume_role_policy = data.aws_iam_policy_document.assume_role.json<br />}</p><br /><p>data \"aws_iam_policy_document\" \"example\" {<br />  effect = \"Allow\"</p><br /><p>actions = [<br />    \"logs:CreateLogDelivery\",<br />    \"logs:DeleteLogDelivery\",<br />    \"logs:ListLogDeliveries\",<br />    \"logs:GetLogDelivery\",<br />    \"firehose:TagDeliveryStream\",<br />  ]</p><br /><p>resources = [\"*\"]<br />}</p><br /><p>resource \"aws_iam_role_policy\" \"example\" {<br />  name   = \"test\"<br />  role   = aws_iam_role.example.id<br />  policy = data.aws_iam_policy_document.example.json<br />}</p><br /><h3 id=\"s3-logging\">S3 Logging</h3><br /><p>terraform<br />resource \"aws_flow_log\" \"example\" {<br />  log_destination      = aws_s3_bucket.example.arn<br />  log_destination_type = \"s3\"<br />  traffic_type         = \"ALL\"<br />  vpc_id               = aws_vpc.example.id<br />}</p><br /><p>resource \"aws_s3_bucket\" \"example\" {<br />  bucket = \"example\"<br />}</p><br /><h3 id=\"s3-logging-in-apache-parquet-format-with-per-hour-partitions\">S3 Logging in Apache Parquet format with per-hour partitions</h3><br /><p>terraform<br />resource \"aws_flow_log\" \"example\" {<br />  log_destination      = aws_s3_bucket.example.arn<br />  log_destination_type = \"s3\"<br />  traffic_type         = \"ALL\"<br />  vpc_id               = aws_vpc.example.id<br />  destination_options {<br />    file_format        = \"parquet\"<br />    per_hour_partition = true<br />  }<br />}</p><br /><p>resource \"aws_s3_bucket\" \"example\" {<br />  bucket = \"example\"<br />}</p><br />", "argument-reference": "<h2 id=\"argument-reference\">Argument Reference</h2><p>~&gt; <strong>NOTE:</strong> One of <code>eni_id</code>, <code>subnet_id</code>, <code>transit_gateway_id</code>, <code>transit_gateway_attachment_id</code>, or <code>vpc_id</code> must be specified.</p><p>This argument supports the following arguments:</p><ul><li><code>traffic_type</code> - (Required) The type of traffic to capture. Valid values: <code>ACCEPT</code>,<code>REJECT</code>, <code>ALL</code>.</li><li><code>deliver_cross_account_role</code> - (Optional) ARN of the IAM role that allows Amazon EC2 to publish flow logs across accounts.</li><li><code>eni_id</code> - (Optional) Elastic Network Interface ID to attach to</li><li><code>iam_role_arn</code> - (Optional) The ARN for the IAM role that's used to post flow logs to a CloudWatch Logs log group</li><li><code>log_destination_type</code> - (Optional) The type of the logging destination. Valid values: <code>cloud-watch-logs</code>, <code>s3</code>, <code>kinesis-data-firehose</code>. Default: <code>cloud-watch-logs</code>.</li><li><code>log_destination</code> - (Optional) The ARN of the logging destination. Either <code>log_destination</code> or <code>log_group_name</code> must be set.</li><li><code>log_group_name</code> - (Optional) <strong>Deprecated:</strong> Use <code>log_destination</code> instead. The name of the CloudWatch log group. Either <code>log_group_name</code> or <code>log_destination</code> must be set.</li><li><code>subnet_id</code> - (Optional) Subnet ID to attach to</li><li><code>transit_gateway_id</code> - (Optional) Transit Gateway ID to attach to</li><li><code>transit_gateway_attachment_id</code> - (Optional) Transit Gateway Attachment ID to attach to</li><li><code>vpc_id</code> - (Optional) VPC ID to attach to</li><li><code>log_format</code> - (Optional) The fields to include in the flow log record, in the order in which they should appear.</li><li><code>max_aggregation_interval</code> - (Optional) The maximum interval of time<br />  during which a flow of packets is captured and aggregated into a flow<br />  log record. Valid Values: <code>60</code> seconds (1 minute) or <code>600</code> seconds (10<br />  minutes). Default: <code>600</code>. When <code>transit_gateway_id</code> or <code>transit_gateway_attachment_id</code> is specified, <code>max_aggregation_interval</code> <em>must</em> be 60 seconds (1 minute).</li><li><code>destination_options</code> - (Optional) Describes the destination options for a flow log. More details below.</li><li><code>tags</code> - (Optional) Key-value map of resource tags. If configured with a provider <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block\"><code>default_tags</code> configuration block</a> present, tags with matching keys will overwrite those defined at the provider-level.</li></ul><h3 id=\"destination_options\">destination_options</h3><p>Describes the destination options for a flow log.</p><ul><li><code>file_format</code> - (Optional) The format for the flow log. Default value: <code>plain-text</code>. Valid values: <code>plain-text</code>, <code>parquet</code>.</li><li><code>hive_compatible_partitions</code> - (Optional) Indicates whether to use Hive-compatible prefixes for flow logs stored in Amazon S3. Default value: <code>false</code>.</li><li><code>per_hour_partition</code> - (Optional) Indicates whether to partition the flow log per hour. This reduces the cost and response time for queries. Default value: <code>false</code>.</li></ul>", "attribute-reference": "<h2 id=\"attribute-reference\">Attribute Reference</h2><p>This resource exports the following attributes in addition to the arguments above:</p><ul><li><code>id</code> - The Flow Log ID</li><li><code>arn</code> - The ARN of the Flow Log.</li><li><code>tags_all</code> - A map of tags assigned to the resource, including those inherited from the provider <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block\"><code>default_tags</code> configuration block</a>.</li></ul>", "import": "<h2 id=\"import\">Import</h2><p>In Terraform v1.5.0 and later, use an <a href=\"https://developer.hashicorp.com/terraform/language/import\"><code>import</code> block</a> to import Flow Logs using the <code>id</code>. For example:</p><p>terraform<br />import {<br />  to = aws_flow_log.test_flow_log<br />  id = \"fl-1a2b3c4d\"<br />}</p><p>Using <code>terraform import</code>, import Flow Logs using the <code>id</code>. For example:</p><p>console<br />% terraform import aws_flow_log.test_flow_log fl-1a2b3c4d</p>", "description": "<h1 id=\"resource-aws_flow_log\">Resource: aws_flow_log</h1><p>Provides a VPC/Subnet/ENI/Transit Gateway/Transit Gateway Attachment Flow Log to capture IP traffic for a specific network<br />interface, subnet, or VPC. Logs are sent to a CloudWatch Log Group, a S3 Bucket, or Amazon Kinesis Data Firehose</p>"}