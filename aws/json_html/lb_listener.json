{"resource-aws-lb-listener": "<h1 id=\"resource-aws_lb_listener\">Resource: aws_lb_listener</h1><p>Provides a Load Balancer Listener resource.</p><p>~&gt; <strong>Note:</strong> <code>aws_alb_listener</code> is known as <code>aws_lb_listener</code>. The functionality is identical.</p>", "example-usage": "<h2 id=\"example-usage\">Example Usage</h2><h3 id=\"forward-action\">Forward Action</h3><br /><p>terraform<br />resource \"aws_lb\" \"front_end\" {<br />  # ...<br />}</p><br /><p>resource \"aws_lb_target_group\" \"front_end\" {<br />  # ...<br />}</p><br /><p>resource \"aws_lb_listener\" \"front_end\" {<br />  load_balancer_arn = aws_lb.front_end.arn<br />  port              = \"443\"<br />  protocol          = \"HTTPS\"<br />  ssl_policy        = \"ELBSecurityPolicy-2016-08\"<br />  certificate_arn   = \"arn:aws:iam::187416307283:server-certificate/test_cert_rab3wuqwgja25ct3n4jdj2tzu4\"</p><br /><p>default_action {<br />    type             = \"forward\"<br />    target_group_arn = aws_lb_target_group.front_end.arn<br />  }<br />}</p><br /><p>To a NLB:</p><br /><p>resource \"aws_lb_listener\" \"front_end\" {<br />  load_balancer_arn = aws_lb.front_end.arn<br />  port              = \"443\"<br />  protocol          = \"TLS\"<br />  certificate_arn   = \"arn:aws:iam::187416307283:server-certificate/test_cert_rab3wuqwgja25ct3n4jdj2tzu4\"<br />  alpn_policy       = \"HTTP2Preferred\"</p><br /><p>default_action {<br />    type             = \"forward\"<br />    target_group_arn = aws_lb_target_group.front_end.arn<br />  }<br />}</p><br /><h3 id=\"redirect-action\">Redirect Action</h3><br /><p>terraform<br />resource \"aws_lb\" \"front_end\" {<br />  # ...<br />}</p><br /><p>resource \"aws_lb_listener\" \"front_end\" {<br />  load_balancer_arn = aws_lb.front_end.arn<br />  port              = \"80\"<br />  protocol          = \"HTTP\"</p><br /><p>default_action {<br />    type = \"redirect\"</p><br /><pre><code>redirect {<br />  port        = \"443\"<br />  protocol    = \"HTTPS\"<br />  status_code = \"HTTP_301\"<br />}<br /></code></pre><br /><p>}<br />}</p><br /><h3 id=\"fixed-response-action\">Fixed-response Action</h3><br /><p>terraform<br />resource \"aws_lb\" \"front_end\" {<br />  # ...<br />}</p><br /><p>resource \"aws_lb_listener\" \"front_end\" {<br />  load_balancer_arn = aws_lb.front_end.arn<br />  port              = \"80\"<br />  protocol          = \"HTTP\"</p><br /><p>default_action {<br />    type = \"fixed-response\"</p><br /><pre><code>fixed_response {<br />  content_type = \"text/plain\"<br />  message_body = \"Fixed response content\"<br />  status_code  = \"200\"<br />}<br /></code></pre><br /><p>}<br />}</p><br /><h3 id=\"authenticate-cognito-action\">Authenticate-cognito Action</h3><br /><p>terraform<br />resource \"aws_lb\" \"front_end\" {<br />  # ...<br />}</p><br /><p>resource \"aws_lb_target_group\" \"front_end\" {<br />  # ...<br />}</p><br /><p>resource \"aws_cognito_user_pool\" \"pool\" {<br />  # ...<br />}</p><br /><p>resource \"aws_cognito_user_pool_client\" \"client\" {<br />  # ...<br />}</p><br /><p>resource \"aws_cognito_user_pool_domain\" \"domain\" {<br />  # ...<br />}</p><br /><p>resource \"aws_lb_listener\" \"front_end\" {<br />  load_balancer_arn = aws_lb.front_end.arn<br />  port              = \"80\"<br />  protocol          = \"HTTP\"</p><br /><p>default_action {<br />    type = \"authenticate-cognito\"</p><br /><pre><code>authenticate_cognito {<br />  user_pool_arn       = aws_cognito_user_pool.pool.arn<br />  user_pool_client_id = aws_cognito_user_pool_client.client.id<br />  user_pool_domain    = aws_cognito_user_pool_domain.domain.domain<br />}<br /></code></pre><br /><p>}</p><br /><p>default_action {<br />    type             = \"forward\"<br />    target_group_arn = aws_lb_target_group.front_end.arn<br />  }<br />}</p><br /><h3 id=\"authenticate-oidc-action\">Authenticate-OIDC Action</h3><br /><p>terraform<br />resource \"aws_lb\" \"front_end\" {<br />  # ...<br />}</p><br /><p>resource \"aws_lb_target_group\" \"front_end\" {<br />  # ...<br />}</p><br /><p>resource \"aws_lb_listener\" \"front_end\" {<br />  load_balancer_arn = aws_lb.front_end.arn<br />  port              = \"80\"<br />  protocol          = \"HTTP\"</p><br /><p>default_action {<br />    type = \"authenticate-oidc\"</p><br /><pre><code>authenticate_oidc {<br />  authorization_endpoint = \"https://example.com/authorization_endpoint\"<br />  client_id              = \"client_id\"<br />  client_secret          = \"client_secret\"<br />  issuer                 = \"https://example.com\"<br />  token_endpoint         = \"https://example.com/token_endpoint\"<br />  user_info_endpoint     = \"https://example.com/user_info_endpoint\"<br />}<br /></code></pre><br /><p>}</p><br /><p>default_action {<br />    type             = \"forward\"<br />    target_group_arn = aws_lb_target_group.front_end.arn<br />  }<br />}</p><br /><h3 id=\"gateway-load-balancer-listener\">Gateway Load Balancer Listener</h3><br /><p>terraform<br />resource \"aws_lb\" \"example\" {<br />  load_balancer_type = \"gateway\"<br />  name               = \"example\"</p><br /><p>subnet_mapping {<br />    subnet_id = aws_subnet.example.id<br />  }<br />}</p><br /><p>resource \"aws_lb_target_group\" \"example\" {<br />  name     = \"example\"<br />  port     = 6081<br />  protocol = \"GENEVE\"<br />  vpc_id   = aws_vpc.example.id</p><br /><p>health_check {<br />    port     = 80<br />    protocol = \"HTTP\"<br />  }<br />}</p><br /><p>resource \"aws_lb_listener\" \"example\" {<br />  load_balancer_arn = aws_lb.example.id</p><br /><p>default_action {<br />    target_group_arn = aws_lb_target_group.example.id<br />    type             = \"forward\"<br />  }<br />}</p><br />", "argument-reference": "<h2 id=\"argument-reference\">Argument Reference</h2><p>The following arguments are required:</p><ul><li><code>default_action</code> - (Required) Configuration block for default actions. Detailed below.</li><li><code>load_balancer_arn</code> - (Required, Forces New Resource) ARN of the load balancer.</li></ul><p>The following arguments are optional:</p><ul><li><code>alpn_policy</code> - (Optional)  Name of the Application-Layer Protocol Negotiation (ALPN) policy. Can be set if <code>protocol</code> is <code>TLS</code>. Valid values are <code>HTTP1Only</code>, <code>HTTP2Only</code>, <code>HTTP2Optional</code>, <code>HTTP2Preferred</code>, and <code>None</code>.</li><li><code>certificate_arn</code> - (Optional) ARN of the default SSL server certificate. Exactly one certificate is required if the protocol is HTTPS. For adding additional SSL certificates, see the <a href=\"/docs/providers/aws/r/lb_listener_certificate.html\"><code>aws_lb_listener_certificate</code> resource</a>.</li><li><code>port</code> - (Optional) Port on which the load balancer is listening. Not valid for Gateway Load Balancers.</li><li><code>protocol</code> - (Optional) Protocol for connections from clients to the load balancer. For Application Load Balancers, valid values are <code>HTTP</code> and <code>HTTPS</code>, with a default of <code>HTTP</code>. For Network Load Balancers, valid values are <code>TCP</code>, <code>TLS</code>, <code>UDP</code>, and <code>TCP_UDP</code>. Not valid to use <code>UDP</code> or <code>TCP_UDP</code> if dual-stack mode is enabled. Not valid for Gateway Load Balancers.</li><li><code>ssl_policy</code> - (Optional) Name of the SSL Policy for the listener. Required if <code>protocol</code> is <code>HTTPS</code> or <code>TLS</code>.</li><li><code>tags</code> - (Optional) A map of tags to assign to the resource. If configured with a provider <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block\"><code>default_tags</code> configuration block</a> present, tags with matching keys will overwrite those defined at the provider-level.</li></ul><p>~&gt; <strong>NOTE::</strong> Please note that listeners that are attached to Application Load Balancers must use either <code>HTTP</code> or <code>HTTPS</code> protocols while listeners that are attached to Network Load Balancers must use the <code>TCP</code> protocol.</p><h3 id=\"default_action\">default_action</h3><p>The following arguments are required:</p><ul><li><code>type</code> - (Required) Type of routing action. Valid values are <code>forward</code>, <code>redirect</code>, <code>fixed-response</code>, <code>authenticate-cognito</code> and <code>authenticate-oidc</code>.</li></ul><p>The following arguments are optional:</p><ul><li><code>authenticate_cognito</code> - (Optional) Configuration block for using Amazon Cognito to authenticate users. Specify only when <code>type</code> is <code>authenticate-cognito</code>. Detailed below.</li><li><code>authenticate_oidc</code> - (Optional) Configuration block for an identity provider that is compliant with OpenID Connect (OIDC). Specify only when <code>type</code> is <code>authenticate-oidc</code>. Detailed below.</li><li><code>fixed_response</code> - (Optional) Information for creating an action that returns a custom HTTP response. Required if <code>type</code> is <code>fixed-response</code>.</li><li><code>forward</code> - (Optional) Configuration block for creating an action that distributes requests among one or more target groups. Specify only if <code>type</code> is <code>forward</code>. If you specify both <code>forward</code> block and <code>target_group_arn</code> attribute, you can specify only one target group using <code>forward</code> and it must be the same target group specified in <code>target_group_arn</code>. Detailed below.</li><li><code>order</code> - (Optional) Order for the action. This value is required for rules with multiple actions. The action with the lowest value for order is performed first. Valid values are between <code>1</code> and <code>50000</code>.</li><li><code>redirect</code> - (Optional) Configuration block for creating a redirect action. Required if <code>type</code> is <code>redirect</code>. Detailed below.</li><li><code>target_group_arn</code> - (Optional) ARN of the Target Group to which to route traffic. Specify only if <code>type</code> is <code>forward</code> and you want to route to a single target group. To route to one or more target groups, use a <code>forward</code> block instead.</li></ul><h4 id=\"authenticate_cognito\">authenticate_cognito</h4><p>The following arguments are required:</p><ul><li><code>user_pool_arn</code> - (Required) ARN of the Cognito user pool.</li><li><code>user_pool_client_id</code> - (Required) ID of the Cognito user pool client.</li><li><code>user_pool_domain</code> - (Required) Domain prefix or fully-qualified domain name of the Cognito user pool.</li></ul><p>The following arguments are optional:</p><ul><li><code>authentication_request_extra_params</code> - (Optional) Query parameters to include in the redirect request to the authorization endpoint. Max: 10. Detailed below.</li><li><code>on_unauthenticated_request</code> - (Optional) Behavior if the user is not authenticated. Valid values are <code>deny</code>, <code>allow</code> and <code>authenticate</code>.</li><li><code>scope</code> - (Optional) Set of user claims to be requested from the IdP.</li><li><code>session_cookie_name</code> - (Optional) Name of the cookie used to maintain session information.</li><li><code>session_timeout</code> - (Optional) Maximum duration of the authentication session, in seconds.</li></ul><h5 id=\"authentication_request_extra_params\">authentication_request_extra_params</h5><ul><li><code>key</code> - (Required) Key of query parameter.</li><li><code>value</code> - (Required) Value of query parameter.</li></ul><h4 id=\"authenticate_oidc\">authenticate_oidc</h4><p>The following arguments are required:</p><ul><li><code>authorization_endpoint</code> - (Required) Authorization endpoint of the IdP.</li><li><code>client_id</code> - (Required) OAuth 2.0 client identifier.</li><li><code>client_secret</code> - (Required) OAuth 2.0 client secret.</li><li><code>issuer</code> - (Required) OIDC issuer identifier of the IdP.</li><li><code>token_endpoint</code> - (Required) Token endpoint of the IdP.</li><li><code>user_info_endpoint</code> - (Required) User info endpoint of the IdP.</li></ul><p>The following arguments are optional:</p><ul><li><code>authentication_request_extra_params</code> - (Optional) Query parameters to include in the redirect request to the authorization endpoint. Max: 10.</li><li><code>on_unauthenticated_request</code> - (Optional) Behavior if the user is not authenticated. Valid values: <code>deny</code>, <code>allow</code> and <code>authenticate</code></li><li><code>scope</code> - (Optional) Set of user claims to be requested from the IdP.</li><li><code>session_cookie_name</code> - (Optional) Name of the cookie used to maintain session information.</li><li><code>session_timeout</code> - (Optional) Maximum duration of the authentication session, in seconds.</li></ul><h4 id=\"fixed_response\">fixed_response</h4><p>The following arguments are required:</p><ul><li><code>content_type</code> - (Required) Content type. Valid values are <code>text/plain</code>, <code>text/css</code>, <code>text/html</code>, <code>application/javascript</code> and <code>application/json</code>.</li></ul><p>The following arguments are optional:</p><ul><li><code>message_body</code> - (Optional) Message body.</li><li><code>status_code</code> - (Optional) HTTP response code. Valid values are <code>2XX</code>, <code>4XX</code>, or <code>5XX</code>.</li></ul><h4 id=\"forward\">forward</h4><p>The following arguments are required:</p><ul><li><code>target_group</code> - (Required) Set of 1-5 target group blocks. Detailed below.</li></ul><p>The following arguments are optional:</p><ul><li><code>stickiness</code> - (Optional) Configuration block for target group stickiness for the rule. Detailed below.</li></ul><h5 id=\"target_group\">target_group</h5><p>The following arguments are required:</p><ul><li><code>arn</code> - (Required) ARN of the target group.</li></ul><p>The following arguments are optional:</p><ul><li><code>weight</code> - (Optional) Weight. The range is 0 to 999.</li></ul><h5 id=\"stickiness\">stickiness</h5><p>The following arguments are required:</p><ul><li><code>duration</code> - (Required) Time period, in seconds, during which requests from a client should be routed to the same target group. The range is 1-604800 seconds (7 days).</li></ul><p>The following arguments are optional:</p><ul><li><code>enabled</code> - (Optional) Whether target group stickiness is enabled. Default is <code>false</code>.</li></ul><h4 id=\"redirect\">redirect</h4><p>~&gt; <strong>NOTE::</strong> You can reuse URI components using the following reserved keywords: <code>#{protocol}</code>, <code>#{host}</code>, <code>#{port}</code>, <code>#{path}</code> (the leading \"/\" is removed) and <code>#{query}</code>.</p><p>The following arguments are required:</p><ul><li><code>status_code</code> - (Required) HTTP redirect code. The redirect is either permanent (<code>HTTP_301</code>) or temporary (<code>HTTP_302</code>).</li></ul><p>The following arguments are optional:</p><ul><li><code>host</code> - (Optional) Hostname. This component is not percent-encoded. The hostname can contain <code>#{host}</code>. Defaults to <code>#{host}</code>.</li><li><code>path</code> - (Optional) Absolute path, starting with the leading \"/\". This component is not percent-encoded. The path can contain #{host}, #{path}, and #{port}. Defaults to <code>/#{path}</code>.</li><li><code>port</code> - (Optional) Port. Specify a value from <code>1</code> to <code>65535</code> or <code>#{port}</code>. Defaults to <code>#{port}</code>.</li><li><code>protocol</code> - (Optional) Protocol. Valid values are <code>HTTP</code>, <code>HTTPS</code>, or <code>#{protocol}</code>. Defaults to <code>#{protocol}</code>.</li><li><code>query</code> - (Optional) Query parameters, URL-encoded when necessary, but not percent-encoded. Do not include the leading \"?\". Defaults to <code>#{query}</code>.</li></ul>", "attribute-reference": "<h2 id=\"attribute-reference\">Attribute Reference</h2><p>This resource exports the following attributes in addition to the arguments above:</p><ul><li><code>arn</code> - ARN of the listener (matches <code>id</code>).</li><li><code>id</code> - ARN of the listener (matches <code>arn</code>).</li><li><code>tags_all</code> - A map of tags assigned to the resource, including those inherited from the provider <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block\"><code>default_tags</code> configuration block</a>.</li></ul>", "import": "<h2 id=\"import\">Import</h2><p>In Terraform v1.5.0 and later, use an <a href=\"https://developer.hashicorp.com/terraform/language/import\"><code>import</code> block</a> to import listeners using their ARN. For example:</p><p>terraform<br />import {<br />  to = aws_lb_listener.front_end<br />  id = \"arn:aws:elasticloadbalancing:us-west-2:187416307283:listener/app/front-end-alb/8e4497da625e2d8a/9ab28ade35828f96\"<br />}</p><p>Using <code>terraform import</code>, import listeners using their ARN. For example:</p><p>console<br />% terraform import aws_lb_listener.front_end arn:aws:elasticloadbalancing:us-west-2:187416307283:listener/app/front-end-alb/8e4497da625e2d8a/9ab28ade35828f96</p>", "description": "<h1 id=\"resource-aws_lb_listener\">Resource: aws_lb_listener</h1><p>Provides a Load Balancer Listener resource.</p><p>~&gt; <strong>Note:</strong> <code>aws_alb_listener</code> is known as <code>aws_lb_listener</code>. The functionality is identical.</p>"}