{"resource-aws-ce-anomaly-subscription": "<h1 id=\"resource-aws_ce_anomaly_subscription\">Resource: aws_ce_anomaly_subscription</h1><p>Provides a CE Anomaly Subscription.</p>", "example-usage": "<h2 id=\"example-usage\">Example Usage</h2><h3 id=\"basic-example\">Basic Example</h3><p>terraform<br />resource \"aws_ce_anomaly_monitor\" \"test\" {<br />  name              = \"AWSServiceMonitor\"<br />  monitor_type      = \"DIMENSIONAL\"<br />  monitor_dimension = \"SERVICE\"<br />}</p><p>resource \"aws_ce_anomaly_subscription\" \"test\" {<br />  name      = \"DAILYSUBSCRIPTION\"<br />  threshold = 100<br />  frequency = \"DAILY\"</p><p>monitor_arn_list = [<br />    aws_ce_anomaly_monitor.test.arn,<br />  ]</p><p>subscriber {<br />    type    = \"EMAIL\"<br />    address = \"abc@example.com\"<br />  }<br />}<br /></p><h3 id=\"threshold-expression-example\">Threshold Expression Example</h3><h4 id=\"for-a-specific-dimension\">For a Specific Dimension</h4><p>terraform<br />resource \"aws_ce_anomaly_subscription\" \"test\" {<br />  name      = \"AWSServiceMonitor\"<br />  frequency = \"DAILY\"</p><p>monitor_arn_list = [<br />    aws_ce_anomaly_monitor.test.arn,<br />  ]</p><p>subscriber {<br />    type    = \"EMAIL\"<br />    address = \"abc@example.com\"<br />  }</p><p>threshold_expression {<br />    dimension {<br />      key           = \"ANOMALY_TOTAL_IMPACT_ABSOLUTE\"<br />      values        = [\"100.0\"]<br />      match_options = [\"GREATER_THAN_OR_EQUAL\"]<br />    }<br />  }<br />}<br /></p><h4 id=\"using-an-and-expression\">Using an <code>and</code> Expression</h4><p>terraform<br />resource \"aws_ce_anomaly_subscription\" \"test\" {<br />  name      = \"AWSServiceMonitor\"<br />  frequency = \"DAILY\"</p><p>monitor_arn_list = [<br />    aws_ce_anomaly_monitor.test.arn,<br />  ]</p><p>subscriber {<br />    type    = \"EMAIL\"<br />    address = \"abc@example.com\"<br />  }</p><p>threshold_expression {<br />    and {<br />      dimension {<br />        key           = \"ANOMALY_TOTAL_IMPACT_ABSOLUTE\"<br />        match_options = [\"GREATER_THAN_OR_EQUAL\"]<br />        values        = [\"100\"]<br />      }<br />    }<br />    and {<br />      dimension {<br />        key           = \"ANOMALY_TOTAL_IMPACT_PERCENTAGE\"<br />        match_options = [\"GREATER_THAN_OR_EQUAL\"]<br />        values        = [\"50\"]<br />      }<br />    }<br />  }<br />}<br /></p><h3 id=\"sns-example\">SNS Example</h3><p>terraform<br />resource \"aws_sns_topic\" \"cost_anomaly_updates\" {<br />  name = \"CostAnomalyUpdates\"<br />}</p><p>data \"aws_iam_policy_document\" \"sns_topic_policy\" {<br />  policy_id = \"__default_policy_ID\"</p><p>statement {<br />    sid = \"AWSAnomalyDetectionSNSPublishingPermissions\"</p><pre><code>actions = [  \"SNS:Publish\",]effect = \"Allow\"principals {  type        = \"Service\"  identifiers = [\"costalerts.amazonaws.com\"]}resources = [  aws_sns_topic.cost_anomaly_updates.arn,]</code></pre><p>}</p><p>statement {<br />    sid = \"__default_statement_ID\"</p><pre><code>actions = [  \"SNS:Subscribe\",  \"SNS:SetTopicAttributes\",  \"SNS:RemovePermission\",  \"SNS:Receive\",  \"SNS:Publish\",  \"SNS:ListSubscriptionsByTopic\",  \"SNS:GetTopicAttributes\",  \"SNS:DeleteTopic\",  \"SNS:AddPermission\",]condition {  test     = \"StringEquals\"  variable = \"AWS:SourceOwner\"  values = [    var.account-id,  ]}effect = \"Allow\"principals {  type        = \"AWS\"  identifiers = [\"*\"]}resources = [  aws_sns_topic.cost_anomaly_updates.arn,]</code></pre><p>}<br />}</p><p>resource \"aws_sns_topic_policy\" \"default\" {<br />  arn = aws_sns_topic.cost_anomaly_updates.arn</p><p>policy = data.aws_iam_policy_document.sns_topic_policy.json<br />}</p><p>resource \"aws_ce_anomaly_monitor\" \"anomaly_monitor\" {<br />  name              = \"AWSServiceMonitor\"<br />  monitor_type      = \"DIMENSIONAL\"<br />  monitor_dimension = \"SERVICE\"<br />}</p><p>resource \"aws_ce_anomaly_subscription\" \"realtime_subscription\" {<br />  name      = \"RealtimeAnomalySubscription\"<br />  threshold = 0<br />  frequency = \"IMMEDIATE\"</p><p>monitor_arn_list = [<br />    aws_ce_anomaly_monitor.anomaly_monitor.arn,<br />  ]</p><p>subscriber {<br />    type    = \"SNS\"<br />    address = aws_sns_topic.cost_anomaly_updates.arn<br />  }</p><p>depends_on = [<br />    aws_sns_topic_policy.default,<br />  ]<br />}<br /></p>", "argument-reference": "<h2 id=\"argument-reference\">Argument Reference</h2><p>The following arguments are required:</p><ul><li><code>account_id</code> - (Optional) The unique identifier for the AWS account in which the anomaly subscription ought to be created.</li><li><code>frequency</code> - (Required) The frequency that anomaly reports are sent. Valid Values: <code>DAILY</code> | <code>IMMEDIATE</code> | <code>WEEKLY</code>.</li><li><code>monitor_arn_list</code> - (Required) A list of cost anomaly monitors.</li><li><code>name</code> - (Required) The name for the subscription.</li><li><code>subscriber</code> - (Required) A subscriber configuration. Multiple subscribers can be defined.<ul><li><code>type</code> - (Required) The type of subscription. Valid Values: <code>SNS</code> | <code>EMAIL</code>.</li><li><code>address</code> - (Required) The address of the subscriber. If type is <code>SNS</code>, this will be the arn of the sns topic. If type is <code>EMAIL</code>, this will be the destination email address.</li></ul></li><li><code>threshold</code> - (Optional) The dollar value that triggers a notification if the threshold is exceeded. Depracated, use <code>threshold_expression</code> instead.</li><li><code>threshold_expression</code> - (Optional) An Expression object used to specify the anomalies that you want to generate alerts for. See <a href=\"#threshold-expression\">Threshold Expression</a>.</li><li><code>tags</code> - (Optional) A map of tags to assign to the resource. If configured with a provider <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block\"><code>default_tags</code> configuration block</a> present, tags with matching keys will overwrite those defined at the provider-level.</li></ul><h3 id=\"threshold-expression\">Threshold Expression</h3><ul><li><code>and</code> - (Optional) Return results that match both <a href=\"#dimension\">Dimension</a> objects.</li><li><code>cost_category</code> - (Optional) Configuration block for the filter that's based on  values. See <a href=\"#cost-category\">Cost Category</a> below.</li><li><code>dimension</code> - (Optional) Configuration block for the specific <a href=\"#dimension\">Dimension</a> to use for.</li><li><code>not</code> - (Optional) Return results that match both <a href=\"#dimension\">Dimension</a> object.</li><li><code>or</code> - (Optional) Return results that match both <a href=\"#dimension\">Dimension</a> object.</li><li><code>tags</code> - (Optional) Configuration block for the specific Tag to use for. See <a href=\"#tags\">Tags</a> below.</li></ul><h3 id=\"cost-category\">Cost Category</h3><ul><li><code>key</code> - (Optional) Unique name of the Cost Category.</li><li><code>match_options</code> - (Optional) Match options that you can use to filter your results. MatchOptions is only applicable for actions related to cost category. The default values for MatchOptions is <code>EQUALS</code> and <code>CASE_SENSITIVE</code>. Valid values are: <code>EQUALS</code>,  <code>ABSENT</code>, <code>STARTS_WITH</code>, <code>ENDS_WITH</code>, <code>CONTAINS</code>, <code>CASE_SENSITIVE</code>, <code>CASE_INSENSITIVE</code>.</li><li><code>values</code> - (Optional) Specific value of the Cost Category.</li></ul><h3 id=\"dimension\">Dimension</h3><ul><li><code>key</code> - (Optional) Unique name of the Cost Category.</li><li><code>match_options</code> - (Optional) Match options that you can use to filter your results. MatchOptions is only applicable for actions related to cost category. The default values for MatchOptions is <code>EQUALS</code> and <code>CASE_SENSITIVE</code>. Valid values are: <code>EQUALS</code>,  <code>ABSENT</code>, <code>STARTS_WITH</code>, <code>ENDS_WITH</code>, <code>CONTAINS</code>, <code>CASE_SENSITIVE</code>, <code>CASE_INSENSITIVE</code>.</li><li><code>values</code> - (Optional) Specific value of the Cost Category.</li></ul><h3 id=\"tags\">Tags</h3><ul><li><code>key</code> - (Optional) Key for the tag.</li><li><code>match_options</code> - (Optional) Match options that you can use to filter your results. MatchOptions is only applicable for actions related to cost category. The default values for MatchOptions is <code>EQUALS</code> and <code>CASE_SENSITIVE</code>. Valid values are: <code>EQUALS</code>,  <code>ABSENT</code>, <code>STARTS_WITH</code>, <code>ENDS_WITH</code>, <code>CONTAINS</code>, <code>CASE_SENSITIVE</code>, <code>CASE_INSENSITIVE</code>.</li><li><code>values</code> - (Optional) Specific value of the Cost Category.</li></ul>", "attribute-reference": "<h2 id=\"attribute-reference\">Attribute Reference</h2><p>This resource exports the following attributes in addition to the arguments above:</p><ul><li><code>arn</code> - ARN of the anomaly subscription.</li><li><code>id</code> - Unique ID of the anomaly subscription. Same as <code>arn</code>.</li><li><code>tags_all</code> - A map of tags assigned to the resource, including those inherited from the provider <a href=\"https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block\"><code>default_tags</code> configuration block</a>.</li></ul>", "import": "<h2 id=\"import\">Import</h2><p>In Terraform v1.5.0 and later, use an <a href=\"https://developer.hashicorp.com/terraform/language/import\"><code>import</code> block</a> to import <code>aws_ce_anomaly_subscription</code> using the <code>id</code>. For example:</p><p><code>terraformimport {  to = aws_ce_anomaly_subscription.example  id = \"AnomalySubscriptionARN\"}</code></p><p>Using <code>terraform import</code>, import <code>aws_ce_anomaly_subscription</code> using the <code>id</code>. For example:</p><p><code>console% terraform import aws_ce_anomaly_subscription.example AnomalySubscriptionARN</code></p>", "description": "<h1 id=\"resource-aws_ce_anomaly_subscription\">Resource: aws_ce_anomaly_subscription</h1><p>Provides a CE Anomaly Subscription.</p>"}