{"ibm-cos-bucket-replication-rule": "<h1 id=\"ibm_cos_bucket_replication_rule\">ibm_cos_bucket_replication_rule</h1><p>Create/replaces or delete replication configuration on an existing bucket. For more information, about configuration options, see <a href=\"https://cloud.ibm.com/docs/cloud-object-storage?topic=cloud-object-storage-replication-overview\">Replicating objects</a>. </p><p>To configure a replication policy on a bucket, you must enable object versioning on both source and destination buckets by using the <a href=\"https://cloud.ibm.com/docs/cloud-object-storage?topic=cloud-object-storage-versioning\">Versioning objects</a>.</p><p><strong>Note:</strong></p><p>you must have <code>writer</code> or <code>manager</code> platform roles on source bucket and sufficient platform roles to create new <a href=\"https://cloud.ibm.com/docs/account?topic=account-iamoverview#iamoverview\">IAM policies</a> that allow the source bucket to write to the destination bucket.<br /> Add depends_on on ibm_iam_authorization_policy.policy in template to make sure replication only enabled once iam  authorization policy set. <br /> We are addressing Create functionality for replication now. Update functionality will be in-progress.</p><hr />", "example-usage": "<h2 id=\"example-usage\">Example usage</h2><p>The following example creates an instance of IBM Cloud Object Storage. Then, multiple buckets are created and configured replication policy.</p><p>terraform<br />data \"ibm_resource_group\" \"cos_group\" {<br />  name = \"cos-resource-group\"<br />}</p><p>resource \"ibm_resource_instance\" \"cos_instance_source\" {<br />  name              = \"cos-instance-src\"<br />  resource_group_id = data.ibm_resource_group.cos_group.id<br />  service           = \"cloud-object-storage\"<br />  plan              = \"standard\"<br />  location          = \"global\"<br />}</p><p>resource \"ibm_resource_instance\" \"cos_instance_destination\" {<br />  name              = \"cos-instance-dest\"<br />  resource_group_id = data.ibm_resource_group.cos_group.id<br />  service           = \"cloud-object-storage\"<br />  plan              = \"standard\"<br />  location          = \"global\"<br />}</p><p>resource \"ibm_cos_bucket\" \"cos_bucket_source\" {<br />  bucket_name           = \"a-bucket-source\"<br />  resource_instance_id = ibm_resource_instance.cos_instance_source.id<br />  region_location      = \"us-south\"<br />  storage_class         = \"standard\"<br />  object_versioning {<br />    enable  = true<br />  }<br />}</p><p>resource \"ibm_cos_bucket\" \"cos_bucket_destination\" {<br />  bucket_name           = \"a-bucket-destination\"<br />  resource_instance_id = ibm_resource_instance.cos_instance_destination.id<br />  region_location      = \"us-south\"<br />  storage_class         = \"standard\"<br />  object_versioning {<br />    enable  = true<br />  }<br />}</p><h3 id=\"configure-iam-authorization-policy\">Configure IAM authorization policy</h3><p>resource \"ibm_iam_authorization_policy\" \"policy\" {<br />  roles                  = [<br />      \"Writer\",<br />  ]<br />  subject_attributes {<br />    name  = \"accountId\"<br />    value = \"an-account-id\"<br />  }<br />  subject_attributes {<br />    name  = \"serviceName\"<br />    value = \"cloud-object-storage\"<br />  }<br />  subject_attributes {<br />    name  = \"serviceInstance\"<br />    value = ibm_resource_instance.cos_instance_source.guid<br />  }<br />  subject_attributes {<br />    name  = \"resource\"<br />    value = ibm_cos_bucket.cos_bucket_source.bucket_name<br />  }<br />  subject_attributes {<br />    name  = \"resourceType\"<br />    value = \"bucket\"<br />  }<br />  resource_attributes {<br />    name     = \"accountId\"<br />    value    = \"an-account-id\"<br />  }<br />  resource_attributes {<br />    name     = \"serviceName\"<br />    value    = \"cloud-object-storage\"<br />  }<br />  resource_attributes { <br />    name  =  \"serviceInstance\"<br />    value =  ibm_resource_instance.cos_instance_destination.guid<br />  }<br />  resource_attributes { <br />    name  =  \"resource\"<br />    value =   ibm_cos_bucket.cos_bucket_destination.bucket_name<br />  }<br />  resource_attributes { <br />    name  =  \"resourceType\"<br />    value =  \"bucket\" <br />  }<br />}</p><h3 id=\"configure-replication-policy\">Configure replication policy</h3><p>resource \"ibm_cos_bucket_replication_rule\" \"cos_bucket_repl\" {<br />  depends_on = [<br />      ibm_iam_authorization_policy.policy<br />  ]<br />  bucket_crn        = ibm_cos_bucket.cos_bucket_source.crn<br />  bucket_location = ibm_cos_bucket.cos_bucket_source.region_location<br />  replication_rule {<br />    rule_id = \"a-rule-id\"<br />    enable = \"true\"<br />    prefix = \"a-prefix\"<br />    priority = \"a-priority-associated-with-the-rule\"<br />    deletemarker_replication_status = \"Enabled/Suspened\"<br />    destination_bucket_crn = ibm_cos_bucket.cos_bucket_destination.crn<br />  }<br />}</p><p></p>", "argument-reference": "<h2 id=\"argument-reference\">Argument reference</h2><p>Review the argument references that you can specify for your resource. <br />- <code>bucket_crn</code> - (Required, Forces new resource, String) The CRN of the COS bucket.<br />- <code>bucket_location</code> - (Required, Forces new resource, String) The location of the COS bucket.<br />- <code>endpoint_type</code>- (Optional, String) The type of the endpoint either <code>public</code> or <code>private</code> or <code>direct</code> to be used for buckets. Default value is <code>public</code>.<br />- <code>replication_rule</code>- (Required, List) Nested block have the following structure:</p><p>Nested scheme for <code>replication_rule</code>:<br />  - <code>rule_id</code>- (Optional, String) The rule id.<br />  - <code>enable</code>-  (Required, Bool) Specifies whether the rule is enabled. Specify true for Enabling it  or false for Disabling it.<br />  - <code>prefix</code>- (Optional, String) An object key name prefix that identifies the subset of objects to which the rule applies.<br />  - <code>priority</code>- (Optional, Int) A priority is associated with each rule. The rule will be applied in a higher priority if there are multiple rules configured. The higher the number, the higher the priority<br />  - <code>deletemarker_replication_status</code>-  (Optional, Bool) Specifies whether Object storage replicates delete markers.Specify true for Enabling it  or false for Disabling it.<br />  - <code>destination_bucket_crn</code>-  (Required, String) The CRN of your destination bucket that you want to replicate to.</p>", "attribute-reference": "<h2 id=\"attribute-reference\">Attribute reference</h2><p>In addition to all argument reference list, you can access the following attribute reference after your resource is created.</p><ul><li><code>crn</code> - (String) The CRN of the bucket.</li><li><code>id</code> - (String) The ID of the bucket.</li></ul>", "import-ibm-cos-bucket": "<h2 id=\"import-ibm-cos-bucket\">Import IBM COS Bucket</h2><p>The <code>ibm_cos_bucket_replication_rule</code> resource can be imported by using the <code>id</code>. The ID is formed from the <code>CRN</code> (Cloud Resource Name). The <code>CRN</code> and bucket location can be found on the portal.</p><p>id = <code>$CRN:meta:$bucketlocation:$endpointtype</code></p><p><strong>Syntax</strong></p><p><code>``$ terraform import ibm_cos_bucket_replication_rule.mybucket</code>$CRN:meta:$bucketlocation:public`</p><p></p><p><strong>Example</strong></p><p></p><p>$ terraform import ibm_cos_bucket_replication_rule.mybucket crn:v1:bluemix:public:cloud-object-storage:global:a/4ea1882a2d3401ed1e459979941966ea:31fa970d-51d0-4b05-893e-251cba75a7b3:bucket:mybucketname:meta:us-south:public</p><p></p>", "description": ""}