{"ibm-iam-service-policy": "<h1 id=\"ibm_iam_service_policy\">ibm_iam_service_policy</h1><p>Create, update, or delete an IAM service policy. For more information, about IAM role action, see <a href=\"https://cloud.ibm.com/docs/account?topic=account-assign-access-resources\">managing access to resources</a>.</p>", "example-usage": "<h2 id=\"example-usage\">Example usage</h2><h3 id=\"service-policy-for-all-identity-and-access-enabled-services\">Service policy for all Identity and Access enabled services</h3><br /><p>terraform<br />resource \"ibm_iam_service_id\" \"service_id\" {<br />  name = \"test\"<br />}</p><br /><p>resource \"ibm_iam_service_policy\" \"policy\" {<br />  iam_service_id = ibm_iam_service_id.service_id.id<br />  roles          = [\"Viewer\"]<br />  description    = \"IAM Service Policy\"</p><br /><p>resource_tags {<br />    name = \"env\"<br />    value = \"dev\"<br />  }</p><br /><p>transaction_id     = \"terraformServicePolicy\"<br />}</p><br /><h3 id=\"service-policy-using-service-with-region\">Service Policy using service with region</h3><br /><p>terraform<br />resource \"ibm_iam_service_id\" \"service_id\" {<br />  name = \"test\"<br />}</p><br /><p>resource \"ibm_iam_service_policy\" \"policy\" {<br />  iam_service_id = ibm_iam_service_id.service_id.id<br />  roles          = [\"Viewer\", \"Manager\"]</p><br /><p>resources {<br />    service = \"cloudantnosqldb\"<br />    region  = \"us-south\"<br />  }<br />}</p><br /><h3 id=\"service-policy-by-using-resource-instance\">Service policy by using resource instance</h3><br /><p>terraform<br />resource \"ibm_iam_service_id\" \"service_id\" {<br />  name = \"test\"<br />}</p><br /><p>resource \"ibm_resource_instance\" \"instance\" {<br />  name     = \"test\"<br />  service  = \"kms\"<br />  plan     = \"tiered-pricing\"<br />  location = \"us-south\"<br />}</p><br /><p>resource \"ibm_iam_service_policy\" \"policy\" {<br />  iam_service_id = ibm_iam_service_id.service_id.id<br />  roles          = [\"Manager\", \"Viewer\", \"Administrator\"]</p><br /><p>resources {<br />    service              = \"kms\"<br />    resource_instance_id = element(split(\":\", ibm_resource_instance.instance.id), 7)<br />  }<br />}</p><br /><h3 id=\"service-policy-by-using-resource-group\">Service policy by using resource group</h3><br /><p>terraform<br />resource \"ibm_iam_service_id\" \"service_id\" {<br />  name = \"test\"<br />}</p><br /><p>data \"ibm_resource_group\" \"group\" {<br />  name = \"default\"<br />}</p><br /><p>resource \"ibm_iam_service_policy\" \"policy\" {<br />  iam_service_id = ibm_iam_service_id.service_id.id<br />  roles          = [\"Viewer\"]</p><br /><p>resources {<br />    service           = \"containers-kubernetes\"<br />    resource_group_id = data.ibm_resource_group.group.id<br />  }<br />}</p><br /><h3 id=\"service-policy-by-using-resource-and-resource-type\">Service policy by using resource and resource type</h3><br /><p>terraform<br />resource \"ibm_iam_service_id\" \"service_id\" {<br />  name = \"test\"<br />}</p><br /><p>data \"ibm_resource_group\" \"group\" {<br />  name = \"default\"<br />}</p><br /><p>resource \"ibm_iam_service_policy\" \"policy\" {<br />  iam_service_id = ibm_iam_service_id.service_id.id<br />  roles          = [\"Administrator\"]</p><br /><p>resources {<br />    resource_type = \"resource-group\"<br />    resource      = data.ibm_resource_group.group.id<br />  }<br />}</p><br /><h3 id=\"service-policy-by-using-attributes\">Service policy by using attributes</h3><br /><p>terraform<br />resource \"ibm_iam_service_id\" \"service_id\" {<br />  name = \"test\"<br />}</p><br /><p>data \"ibm_resource_group\" \"group\" {<br />  name = \"default\"<br />}</p><br /><p>resource \"ibm_iam_service_policy\" \"policy\" {<br />  iam_service_id = ibm_iam_service_id.service_id.id<br />  roles          = [\"Administrator\"]</p><br /><p>resources {<br />    service = \"is\"</p><br /><pre><code>attributes = {<br />  \"vpcId\" = \"*\"<br />}<br /></code></pre><br /><p>}<br />}</p><br /><h3 id=\"cross-account-service-policy-by-using-iam_id\">Cross account service policy by using <code>iam_id</code></h3><br /><p>terraform<br />provider \"ibm\" {<br />    alias             = \"accA\"<br />    ibmcloud_api_key  = \"Account A Api Key\"<br />}<br />resource \"ibm_iam_service_id\" \"service_id\" {<br />  provider = ibm.accA<br />  name     = \"test\"<br />}</p><br /><p>provider \"ibm\" {<br />    alias             = \"accB\"<br />    ibmcloud_api_key  = \"Account B Api Key\"<br />}<br />resource \"ibm_iam_service_policy\" \"policy\" {<br />  provider       =  ibm.accB<br />  iam_id         =  ibm_iam_service_id.service_id.iam_id<br />  roles          =  [\"Reader\"]<br />  resources {<br />    service = \"cloud-object-storage\"<br />  }<br />}</p><br /><h3 id=\"service-policy-by-using-resource_attributes\">Service policy by using resource_attributes</h3><br /><p>terraform<br />resource \"ibm_iam_service_id\" \"service_id\" {<br />  name = \"test\"<br />}<br />resource \"ibm_iam_service_policy\" \"policy\" {<br />  iam_service_id = ibm_iam_service_id.service_id.id<br />  roles           = [\"Viewer\"]<br />  resource_attributes {<br />    name  = \"resource\"<br />    value = \"test123*\"<br />    operator = \"stringMatch\"<br />  }<br />  resource_attributes {<br />    name  = \"serviceName\"<br />    value = \"messagehub\"<br />  }<br />}</p><br /><h3 id=\"service-policy-using-service_type-with-region\">Service Policy using service_type with region</h3><br /><p>terraform<br />resource \"ibm_iam_service_id\" \"service_id\" {<br />  name = \"test\"<br />}</p><br /><p>resource \"ibm_iam_service_policy\" \"policy\" {<br />  iam_service_id = ibm_iam_service_id.service_id.id<br />  roles          = [\"Viewer\"]</p><br /><p>resources {<br />    service_type = \"service\"<br />    region = \"us-south\"<br />    }<br />}</p><br /><h3 id=\"service-policy-by-using-service-and-rule_conditions\">Service Policy by using service and rule_conditions</h3><br /><p><code>rule_conditions</code> can be used in conjunction with <code>pattern</code> and <code>rule_operator</code> to implement service policies with time-based conditions. For information see <a href=\"https://cloud.ibm.com/docs/account?topic=account-iam-time-based&amp;interface=ui\">Limiting access with time-based conditions</a>. <strong>Note</strong> Currently, a policy resource created without <code>rule_conditions</code>, <code>pattern</code>, and <code>rule_operator</code> cannot be updated including those conditions on update.</p><br /><p>terraform<br />resource \"ibm_iam_service_id\" \"service_id\" {<br />  name = \"test\"<br />}</p><br /><p>resource \"ibm_iam_service_policy\" \"policy\" {<br />  iam_service_id = ibm_iam_service_id.service_id.id<br />  roles      = [\"Viewer\"]<br />  resources {<br />    service = \"kms\"<br />  }<br />  rule_conditions {<br />    key = \"{{environment.attributes.day_of_week}}\"<br />    operator = \"dayOfWeekAnyOf\"<br />    value = [\"1+00:00\",\"2+00:00\",\"3+00:00\",\"4+00:00\"]<br />  }<br />  rule_conditions {<br />    key = \"{{environment.attributes.current_time}}\"<br />    operator = \"timeGreaterThanOrEquals\"<br />    value = [\"09:00:00+00:00\"]<br />  }<br />  rule_conditions {<br />    key = \"{{environment.attributes.current_time}}\"<br />    operator = \"timeLessThanOrEquals\"<br />    value = [\"17:00:00+00:00\"]<br />  }<br />  rule_operator = \"and\"<br />  pattern = \"time-based-conditions:weekly:custom-hours\"<br />}</p><br /><h3 id=\"service-policy-by-using-service_group_id-resource-attribute\">Service Policy by using service_group_id resource attribute</h3><br /><p>terraform<br />resource \"ibm_iam_service_id\" \"service_id\" {<br />  name = \"test\"<br />}</p><br /><p>resource \"ibm_iam_service_policy\" \"policy\" {<br />  roles  = [\"Service ID creator\", \"User API key creator\", \"Administrator\"]<br />  resource_attributes {<br />    name     = \"service_group_id\"<br />    operator = \"stringEquals\"<br />    value    = \"IAM\"<br />  }<br />}</p><br />", "argument-reference": "<h2 id=\"argument-reference\">Argument reference</h2><p>Review the argument references that you can specify for your resource. </p><ul><li><code>account_management</code> - (Optional, Bool) Gives access to all account management services if set to <strong>true</strong>. Default value is <strong>false</strong>. If you set this option, do not set <code>resources</code> at the same time.<strong>Note</strong> Conflicts with <code>resources</code> and <code>resource_attributes</code>.</li><li><code>description</code>  (Optional, String) The description of the IAM Service Policy.</li><li><code>iam_service_id</code> - (Required, Forces new resource, String) The UUID of the service ID.</li><li><code>iam_id</code> - (Optional,  Forces new resource, String) IAM ID of the service ID. Used to assign cross account service ID policy. Either <code>iam_service_id</code> or <code>iam_id</code> is required.</li><li><code>resources</code> - (List of Objects) Optional- A nested block describes the resource of this policy.<strong>Note</strong> Conflicts with <code>account_management</code> and <code>resource_attributes</code>.</li></ul><p>Nested scheme for <code>resources</code>:<br />  - <code>service</code>  (Optional, String) The service name of the policy definition. You can retrieve the value by running the <code>ibmcloud catalog service-marketplace</code> or <code>ibmcloud catalog search</code>. Attributes service, service_type are mutually exclusive.<br />  - <code>service_type</code>  (Optional, String) The service type of the policy definition. <strong>Note</strong> Attributes service, service_type are mutually exclusive.<br />  - <code>resource_instance_id</code> - (Optional, String) The ID of the resource instance of the policy definition.<br />  - <code>region</code> - (Optional, String) The region of the policy definition.<br />  - <code>resource_type</code> - (Optional, String) The resource type of the policy definition.<br />  - <code>resource</code> - (Optional, String) The resource of the policy definition.<br />  - <code>resource_group_id</code> - (Optional, String) The ID of the resource group. To retrieve the value, run <code>ibmcloud resource groups</code> or use the <code>ibm_resource_group</code> data source.<br />  - <code>service_group_id</code> (Optional, String) The service group id of the policy definition. <strong>Note</strong> Attributes service, service_group_id are mutually exclusive.<br />  - <code>attributes</code> (Optional, Map)  A set of resource attributes in the format <code>name=value,name=value</code>. If you set this option, do not specify <code>account_management</code> and <code>resource_attributes</code> at the same time.<br />- <code>resource_attributes</code> - (Optional, list) A nested block describing the resource of this policy. - <code>resource_attributes</code> - (Optional, List) A nested block describing the resource of this policy. <strong>Note</strong> Conflicts with <code>account_management</code> and <code>resources</code>.</p><p>Nested scheme for <code>resource_attributes</code>:<br />  - <code>name</code> - (Required, String) The name of an attribute. Supported values are <code>serviceName</code> , <code>serviceInstance</code> , <code>region</code> ,<code>resourceType</code> , <code>resource</code> , <code>resourceGroupId</code>, <code>service_group_id</code>, and other service specific resource attributes.<br />  - <code>value</code> - (Required, String) The value of an attribute.<br />  - <code>operator</code> - (Optional, String) Operator of an attribute. The default value is <code>stringEquals</code>. <strong>Note</strong> Conflicts with <code>account_management</code> and <code>resources</code>.<br />- <code>roles</code> - (Required, List) A comma separated list of roles. Valid roles are <code>Writer</code>, <code>Reader</code>, <code>Manager</code>, <code>Administrator</code>, <code>Operator</code>, <code>Viewer</code>, and <code>Editor</code>. For more information, about supported service specific roles, see  <a href=\"https://cloud.ibm.com/docs/account?topic=account-iam-service-roles-actions\">IAM roles and actions</a></p><ul><li><code>resource_tags</code>  (Optional, List)  A nested block describing the access management tags.  <strong>Note</strong> <code>resource_tags</code> are only allowed in policy with resource attribute serviceType, where value is equal to service.</li></ul><p>Nested scheme for <code>resource_tags</code>:<br />  - <code>name</code> - (Required, String) The key of an access management tag. <br />  - <code>value</code> - (Required, String) The value of an access management tag.<br />  - <code>operator</code> - (Optional, String) Operator of an attribute. The default value is <code>stringEquals</code>.</p><ul><li><p><code>transaction_id</code>- (Optional, String) The TransactionID can be passed to your request for tracking the calls.</p></li><li><p><code>rule_conditions</code> - (Optional, List) A nested block describing the rule conditions of this policy.</p></li></ul><p>Nested schema for <code>rule_conditions</code>:<br />  - <code>key</code> - (Required, String) The key of a rule condition.<br />  - <code>operator</code> - (Required, String) The operator of a rule condition.<br />  - <code>value</code> - (Required, List) The valjue of a rule condition.</p><ul><li><p><code>rule_operator</code> - (Optional, String) The operator used to evaluate multiple rule conditions, e.g., all must be satisfied with <code>and</code>.</p></li><li><p><code>pattern</code> - (Optional, String) The pattern that the rule follows, e.g., <code>time-based-conditions:weekly:all-day</code>.</p></li></ul>", "attribute-reference": "<h2 id=\"attribute-reference\">Attribute reference</h2><p>In addition to all argument reference list, you can access the following attribute reference after your resource is created.</p><ul><li><code>id</code>  - (String) The unique identifier of the service policy. The ID is composed of <code>&lt;iam_service_id&gt;/&lt;service_policy_id&gt;</code>. If policy is created by using <code>&lt;iam_service_id&gt;</code>. The ID is composed of <code>&lt;iam_id&gt;/&lt;service_policy_id&gt;</code> if policy is created by using <code>&lt;iam_id&gt;</code>.</li><li><code>version</code>  - (String) The version of the service policy.</li></ul>", "import": "<h2 id=\"import\">Import</h2><p>The  <code>ibm_iam_service_policy</code> resource can be imported by using service ID and service policy ID or IAM ID and service policy ID.</p><p><strong>Syntax</strong></p><p>$ terraform import ibm_iam_service_policy.example <service_ID>/<service_policy_ID></p><p><strong>Example</strong></p><p>$ terraform import ibm_iam_service_policy.example ServiceId-d7bec597-4726-451f-8a63-e62e6f19c32c/cea6651a-bc0a-4438-9f8a-a0770bbf3ebb</p>", "description": "<h1 id=\"ibm_iam_service_policy\">ibm_iam_service_policy</h1><p>Create, update, or delete an IAM service policy. For more information, about IAM role action, see <a href=\"https://cloud.ibm.com/docs/account?topic=account-assign-access-resources\">managing access to resources</a>.</p>"}