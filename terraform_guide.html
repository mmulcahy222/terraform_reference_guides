<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terraform Guide</title>
    <style>
        @font-face {
            font-family: 'dos';
            /* You can choose any name you like */
            src: url('dos.ttf') format('truetype');
            /* Replace 'path/to' with the actual file path */
            /* You can also include other font formats like woff, woff2, eot for better browser compatibility */
        }

        * {
            box-sizing: border-box;
        }

        html,
        body,
        #container {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow-y: scroll;
        }

        :root {
            --right-column: #0000a0;
            /* Define a variable for scrollbar background color */
        }


        li {
            text-decoration-style: none;
            list-style-type: none;
            margin: 0;
        }

        body {
            background-color: black;
            color: #c0c0c0;
            margin: 0;
            padding: 0;
            font-family: 'dos';
        }

        /* Style the link (a) for all states */
        a,
        a:visited,
        a:hover,
        a:active {
            color: white;
            /* Set the text color to white */
            text-decoration: none;
            /* Remove underline and other text decorations */
            cursor: pointer;
        }

        h1,
        h2 {
            display: none;
        }

        .scrollable {
            overflow-y: auto;
            color: white;
            scrollbar-width: thin;
            scrollbar-color: #202020 #000;
            text-decoration: none;
        }


        #container {
            color: #808080;
            /* DOS Gray Color */
        }

        #left-column {
            width: 20%;
            height: 100%;
            overflow-x: hidden;
            float: left;

        }

        #left-column ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }


        /* Set the right column to a flex container with column direction */
        #right-column {
            width: 80%;
            float: left;
            background-color: #0000a0;
        }



        /* Add this CSS to your existing styles */
        #bottom-right {
            height: 100%;
            float: right;
            box-sizing: border-box;
        }

        /* Style for the header */
        /* Style for the header */
        #header {
            background-color: #c0c0c0;
            display: table;
            /* Use table layout */
            width: 100%;
            table-layout: fixed;
            /* Fix the table layout */
            position: sticky;
            top: 0;
            cursor: pointer;
        }

        .header-item {
            color: #0000a0;
            height: 5vh;
            display: table-cell;
            /* Use table-cell layout */
            vertical-align: middle;
            /* Vertically center content */
            text-align: center;
            overflow: hidden;
        }

        .header-item *
        {
            color: #0000a0;
        }

       

        .header-item .submenus
        {
            position: absolute;
            width: 20vh;
            transform: translateY(15px);
        }

        

       .submenu {
            padding: 10px 8px;
            margin-bottom: 6px;
            background-color: #c0c0c0;
        }


        div {
            overflow-y: auto;
            overflow-x: auto;
        }

        /* Style for the resource-description */
        #resource-description {
            color: #fff;
            padding: 5px;
            box-sizing: border-box;
            height: 10vh;
            width: 100%;
        }


        #resource-description p {
            color: #fff;
            /* Text color for the top bar */
            margin: 5px;
        }


        .columns {
            display: flex;
            height: 75vh;
            /* Fill the remaining space after the header and resource-description */
        }

        .outer-div {
            flex: 1;
            padding: 20px;
        }



        /* Style for the Terraform sections */
        #terraform-example,
        #terraform-description {
            color: #fff;
            padding: 10px;
            box-sizing: border-box;
            width: 100%;
            outline: double;

            outline-offset: 0px;
        }

        #terraform-example p
        {
            display: block;
            margin-block-start: 0.2em;
            margin-block-end: 0.2em;
            margin-inline-start: 0px;
            margin-inline-end: 0px;
        }



        #terraform-example code {
            font-family: "Dos";
        }

        #right-column #terraform-example {
            white-space: pre;
        }

        /* Style for the Terraform Description section */
        #terraform-description {
            color: #fff;
            /* Text color for the Terraform Description section */
            line-height: 20px;
        }

        #terraform-description li {
            margin-bottom: 20px;
        }

        #terraform-description code {
            font-family: "dos";
            color: #33FF57;

        }

        /* Style for the footer */
        #footer {
            background-color: #c0c0c0;
            height: 10vh;
            /* 10% of the container height for the footer */
            position: sticky;
            bottom: 0;
            width: 100%;
        }

        /* Customize scrollbar appearance for Webkit browsers (Chrome, Safari) */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            /*background: #000;*/
        }

        ::-webkit-scrollbar-thumb {
            background: #00AAAA;
        }

        #left-column::-webkit-scrollbar-thumb {
            background: #505050;
        }
    </style>
</head>

<body>
    <div id="container">
        <div id="left-column">
        </div>
        <!-- Within the existing HTML structure -->
        <div id="right-column">
            <div id="header">
                <div class="header-item" id="left_arrow">&#x2190;</div>
                <div class="header-item" id="right_arrow">&#x2192;</div>
                <div class="header-item" id="clouds">
                    <div class="submenu-toggle" id="clouds-toggle">Clouds &#9660;</div>
                    <div class="submenus" id="clouds-dropdown">
                        <div class="submenu" id="cloud_aws">Amazon AWS</div>
                        <div class="submenu" id="cloud_azure">Microsoft Azure</div>
                        <div class="submenu" id="cloud_google">Google Cloud</div>
                        <div class="submenu" id="cloud_ibm">IBM Cloud</div>
                    </div>
                </div>
                <div class="header-item" id="terraform_registry_page">Terraform Registry Page</div>
                <div class="header-item" id="search_simple">Google Simple</div>
                <div class="header-item" id="search_advanced">Google Advanced</div>
                <div class="header-item" id="prompts">
                    <div class="submenu-toggle" id="prompts-toggle">Clipboard Prompts &#9660;</div>
                    <div class="submenus" id="prompts-dropdown">
                        <div class="submenu" id="prompt_1">Prompt 1</div>
                        <div class="submenu" id="prompt_2">Prompt 2</div>
                        <div class="submenu" id="prompt_3">Prompt 3</div>
                    </div>
                </div>

                <div class="header-item" id="open_bard">&#x263A; Open Bard &#x263A;</div>
                <div class="header-item" id="open_chatgpt">&#x263A; Open ChatGPT &#x263A;</div>
            </div>
            <div id="resource-description">

            </div>
            <div class="columns">
                <div class="outer-div">
                    <div id="terraform-example">
                        <!-- Your content for terraform-example goes here -->
                    </div>
                </div>
                <div class="outer-div">
                    <div id="terraform-description">
                        <!-- Your content for terraform-description goes here -->
                    </div>
                </div>
            </div>
            <div id="footer">

            </div>
        </div>

    </div>


    <script>
        // Function to retrieve the 'cloud' query parameter from the URL
        function getCloudQueryParam() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('cloud').replace(/^terraform/, '');
        }



        function change(text) {
            if (text == undefined) return 'N/A';
            text = text.trim().replace(/^(terraform|hcl)/, "").trim()
            return text;
        }

        function get_value_by_part(obj, keyPart, defaultValue = '') {
            try {
                const matchingKey = Object.keys(obj).find(key => key.includes(keyPart));
                return matchingKey ? obj[matchingKey] : defaultValue;
            } catch (error) {
                return defaultValue;
            }
        }





        // Define a global variable for leftColumn
        left_column = document.getElementById('left-column');

        // Function to scroll the active_resource_element to the center
        function scrollActiveResourceToCenter() {
            // Get the center position of #leftcolumn
            const centerPosition = left_column.clientHeight / 2;
            // Scroll to center the active_resource_element in #leftcolumn
            left_column.scrollTop = active_resource_element.offsetTop - centerPosition;
        }



        ////////////////////
        //
        //  COPY TEXT TO CLIPBOARD
        //
        ////////////////////
        function copyTextToClipboard(textToCopy) {
            const textArea = document.createElement("textarea");
            textArea.value = textToCopy;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand("copy");
            document.body.removeChild(textArea);
        }

        ////////////////////
        //
        //  HANDLE CLICKS
        //
        ////////////////////
        active_resource_element = document.createElement("div");
        active_resource_name = '';
        cloud = getCloudQueryParam();

        cloud_map = {
            "ibm-cloud": "IBM Cloud",
            "google": "Google Cloud",
            "azurerm": "Microsoft Azure Cloud",
            "aws": "Amazon AWS Cloud",
        }

        cloud_neat_name = cloud_map[cloud.toLowerCase()] ? cloud_map[cloud.toLowerCase()] : null;

        function getOtherClouds(excludedCloud) {
            // Filter out the excluded cloud
            const otherClouds = Object.values(cloud_map).filter((cloud) => cloud !== cloud_map[excludedCloud]);
            // Join the filtered values into a comma-separated string
            const result = otherClouds.join(', ');
            return result;
        }



        // Function to handle the AJAX request and update content
        function handleResourceLinkClick(fileValue) {
            // Construct the URL for the AJAX request
            const cloudQueryParam = getCloudQueryParam();
            const apiUrl = `${cloudQueryParam}/json_html/${fileValue}.json`; // Update the path as needed

            // Make an AJAX request
            const xhr = new XMLHttpRequest();
            xhr.open('GET', apiUrl, true);
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    const jsonResponse = JSON.parse(xhr.responseText);

                    terraform_example = document.getElementById('terraform-example');
                    terraform_description = document.getElementById('terraform-description');
                    resource_description = document.getElementById('resource-description');
                    // active_resource_name_display = document.getElementById('active_resource_name_display');

                    // Update the HTML content based on the JSON response
                    terraform_example.innerHTML = change(jsonResponse['example-usage']).replace('terraform', '').replace('hcl', '').replace(/(<\s*br\s*\/?\s*>)+/g, '<br />').trim();
                    terraform_description.innerHTML = change(get_value_by_part(jsonResponse, 'argument'));
                    resource_description.innerHTML = active_resource_name + ': '  + change(jsonResponse['description']);

                    terraform_example.scrollTop = 0;
                    terraform_example.scrollLeft = 0;
                    terraform_description.scrollTop = 0;
                    resource_description.scrollTop = 0;
                    document.querySelectorAll(".outer-div").forEach(e => {
                        e.scrollTop = 0;
                        e.scrollLeft = 0;
                    });

                    active_resource_name_display.innerHTML = active_resource_name;

                    window.scrollTo({
                        top: 0,
                        behavior: "auto"
                    });


                    ////////////////////
                    //
                    //  CLEAN
                    //
                    ////////////////////
                    // Remove EMPTY P TAGS
                    // const emptyParagraphs = document.querySelectorAll('#terraform-example p:empty');
                    // emptyParagraphs.forEach((emptyP) => {
                    //     emptyP.remove();
                    // });


                    // // Select all <p> elements within #terraform-example
                    // const pElements = document.querySelectorAll('#terraform-example p');
                    // // Iterate through the <p> elements
                    // pElements.forEach((pElement) => {
                    //     // Check if the first child node of the <p> element is a <br> element
                    //     if (pElement.firstChild && pElement.firstChild.tagName === 'BR') {
                    //         // Remove the <p> element
                    //         pElement.firstChild.remove();
                    //     }
                    // });


                    // Select all <p> elements within #terraform-example
                    const brElements = document.querySelectorAll('#terraform-example br:nth-child(1)');
                    brElements.forEach(brElement => {
                        brElement.parentNode.removeChild(brElement);
                        console.log("REMOVE");
                    });

                }
            };
            xhr.send();
        }

        // Function to handle resource link click events
        function resourceLinkClickHandler(event) {
            if (event.target.classList.contains('resource_link')) {
                event.preventDefault(); // Prevent default link behavior

                // Get the value attribute from the clicked link
                const fileValue = event.target.getAttribute('value');
                active_resource_name = fileValue;

                // Change color on click
                active_resource_element.style.color = "white";
                event.target.style.color = "cyan";
                active_resource_element = event.target;

                // Handle the AJAX request and content update
                handleResourceLinkClick(fileValue);
            }
        }

        // Add click event listener to document for resource links
        document.addEventListener('click', resourceLinkClickHandler);

        // Add click event listeners for left and right arrows
        document.getElementById('left_arrow').addEventListener('click', function (event) {
            // Navigate to the previous sibling element
            const prevSibling = active_resource_element.parentNode.previousSibling;
            if (prevSibling) {
                active_resource_element.style.color = "white";
                active_resource_element = prevSibling.querySelector('.resource_link');
                active_resource_name = active_resource_element.getAttribute('value');
                active_resource_element.style.color = "cyan";
                handleResourceLinkClick(active_resource_name);
                scrollActiveResourceToCenter();
            }
        });

        document.getElementById('right_arrow').addEventListener('click', function (event) {
            // Navigate to the next sibling element
            const nextSibling = active_resource_element.parentNode.nextSibling;
            if (nextSibling) {
                active_resource_element.style.color = "white";
                active_resource_element = nextSibling.querySelector('.resource_link');
                active_resource_name = active_resource_element.getAttribute('value');
                active_resource_element.style.color = "cyan";
                handleResourceLinkClick(active_resource_name);
                scrollActiveResourceToCenter();
            }
        });


        document.getElementById('search_simple').addEventListener('click', function (event) {
            const searchQuery = `${cloud_neat_name} ${active_resource_name}`.replace(/_/g, " ");
            // Encode the search query for a URL
            const encodedQuery = encodeURIComponent(searchQuery);
            // Construct the Google search URL
            const googleSearchURL = `https://www.google.com/search?q=${encodedQuery}`;
            // Open the search in a new tab
            window.open(googleSearchURL, '_blank');
        });


        document.getElementById('search_advanced').addEventListener('click', function (event) {
            const searchQuery = `What is the purpose of ${active_resource_name} in ${cloud_neat_name} plus the equivalent service of ${cloud_neat_name} ${active_resource_name} in the other clouds such as ${getOtherClouds(cloud)}?  Generate AI answer.`.replace(/_/g, " ");
            // Encode the search query for a URL
            const encodedQuery = encodeURIComponent(searchQuery);
            // Construct the Google search URL
            const googleSearchURL = `https://www.google.com/search?q=${encodedQuery}`;
            // Open the search in a new tab
            window.open(googleSearchURL, '_blank');
        });

        document.getElementById('prompt_1').addEventListener('click', function (event) {
            text_query = `What is ${active_resource_name} in ${cloud_neat_name}?`.replace(/_/g, " ");
            copyTextToClipboard(text_query);
        });

        document.getElementById('prompt_2').addEventListener('click', function (event) {
            text_query = `Give me an example of 5 instances/entities ${active_resource_name} in ${cloud_neat_name} that pertains to NBA players.`.replace(/_/g, " ");
            copyTextToClipboard(text_query);
        });

        document.getElementById('prompt_3').addEventListener('click', function (event) {
            terraform_arguments = document.getElementById("terraform-description").innerText;
            other_clouds = getOtherClouds(cloud);
            text_query = `Dear Cloud Terraform expert. Please look at the terraform below of the resource known as ${active_resource_name}. 1) Tell me what this resource is doing & why it exists based off your own knowledge and the arguments below. (Do not explain every single argument/parameter, it was already done in the prompt) 2) Tell me what other resources & services in ${cloud_neat_name} that the resource below is connected to (explain this part relative quickly, and do not do this for every single argument/parameter). 3) In 4 to 8 sentences, give me an fictional example of this resource being in a workplace ("Wawa Corporate") that's oversaturated with hypothetical fictional values everywhere that are highlighted for learning purposes. Use your imagination to this question very heavy by conjuring a random real-world scenario where someone uses ${active_resource_name}. Every noun has either a imaginary scenario or fictional value for learning to set the scene (Note: Wawa is the convenience store in the mid-Atlantic like New Jersey & Pennsylvania) 4) Please in a code window show me Terraform Configuration using every single argument presented below, with hypothetical fictional values in a code window 5) Write me a script between a stakeholder, and boss, and an employee, using imagination & fiction heavy & mock hypothetical fictional VALUES everywhere in technical specifics. Saturate this to the brim with hypothetical fictional values. 7) What are the names of the equivalent services for the other clouds at ${other_clouds} 8) Does this service have any features & concepts specific to ${cloud_neat_name} that is unique to ${cloud_neat_name} & different than ${other_clouds}?:`;
            // text_query = `1) Please in a code window show me Terraform Configuration using every single argument presented below, with hypothetical fictional values in a code window 2) What are the names of the equivalent services for the other clouds at ${other_clouds}:`;

            full_query = text_query + "\n\n" + terraform_arguments;
            copyTextToClipboard(full_query);

        });

        function updateCloudParameter(cloudValue) {
          var currentURL = new URL(window.location.href);
          var params = new URLSearchParams(currentURL.search);
          params.set("cloud", cloudValue);
          currentURL.search = params.toString();
          window.location.href = currentURL.href;
        }

        


        document.getElementById('cloud_aws').addEventListener('click', function (event) {
            updateCloudParameter("aws");
        });
        document.getElementById('cloud_azure').addEventListener('click', function (event) {
            updateCloudParameter("azurerm");
        });
        document.getElementById('cloud_google').addEventListener('click', function (event) {
            updateCloudParameter("google");
        });
        document.getElementById('cloud_ibm').addEventListener('click', function (event) {
            updateCloudParameter("IBM-cloud");
        });

        document.getElementById('terraform_registry_page').addEventListener('click', function (event) {
            terraform_registry_url = `https://registry.terraform.io/providers/hashicorp/${cloud}/latest/docs/resources/${active_resource_name}`;
            window.open(terraform_registry_url, '_blank');
        });

        document.getElementById('open_chatgpt').addEventListener('click', function (event) {
            window.open("https://chat.openai.com/", '_blank');
        });

        document.getElementById('open_bard').addEventListener('click', function (event) {
            window.open("https://bard.google.com/", '_blank');
        });


        //Make the leaf divs have scrollable features!
        document.querySelectorAll('div').forEach((div) => {
            if (div.querySelectorAll('div').length === 0) {
                // If the div has no child divs (leaf div), add the "scrollable" class
                div.classList.add('scrollable');
            }
        });





        ////////////////////
        //
        //  DISPLAY FILES ON LEFT COLUMN
        //
        ////////////////////

        document.addEventListener("DOMContentLoaded", function () {
            // Get the 'cloud' query parameter from the URL
            const urlParams = new URLSearchParams(window.location.search);
            const cloud = urlParams.get("cloud");
            const markdownSource = `${cloud}\\file_names.js`;

            const fileList = document.getElementById("left-column");

            // Create a function to fetch and display the file list
            function displayFileList() {
                fileList.innerHTML = ""; // Clear the list

                // Fetch the list of files
                fetch(markdownSource)
                    .then((response) => response.json())
                    .then((data) => {
                        data.forEach((file) => {
                            if (file !== '.' && file !== '..') {
                                const parts = file.split('.');
                                const filenameWithoutExtension = parts[0];
                                const listItem = document.createElement("li");
                                const link = document.createElement("a");
                                link.href = "";
                                link.classList.add("resource_link");
                                link.setAttribute("value", filenameWithoutExtension);
                                link.textContent = filenameWithoutExtension;
                                listItem.appendChild(link);
                                fileList.appendChild(listItem);
                            }
                        });

                        //initialize
                        document.querySelector("#left-column li a").click();

                    })
                    .catch((error) => {
                        console.error("Error fetching file list:", error);
                    });

            }

            // Call the function to initially display the file list
            displayFileList();




        });





        ////////////////////
        //
        //  SUBMENU
        //
        ////////////////////
        // Get all submenu toggle elements
        const submenuToggles = document.querySelectorAll('.submenu-toggle');

        // Add click event listeners to all submenu toggle elements
        submenuToggles.forEach((toggle) => {
            toggle.addEventListener('click', (e) => {
                e.stopPropagation(); // Prevent the click event from propagating to the document

                // Toggle the display of the submenu underneath the corresponding menu item
                const submenu = toggle.nextElementSibling; // Get the next sibling (the submenu)
                if (submenu.style.display === 'none' || submenu.style.display === '') {
                    submenu.style.display = 'block';
                } else {
                    submenu.style.display = 'none';
                }
            });
        });

        // Add a click event listener to the document to close all submenus when clicking anywhere outside
        document.addEventListener('click', () => {
            // Get all submenus
            const submenus = document.querySelectorAll('.submenus');

            // Close all submenus
            submenus.forEach((submenu) => {
                submenu.style.display = 'none';
            });
        });






    </script>
</body>

</html>